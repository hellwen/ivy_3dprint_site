(function(e){function t(){if(e.fn.ajaxSubmit.debug){var t="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(t):window.opera&&window.opera.postError&&window.opera.postError(t)}}e.fn.ajaxSubmit=function(i){function s(){function s(){var t=c.attr("target"),i=c.attr("action");a.setAttribute("target",h),a.getAttribute("method")!="POST"&&a.setAttribute("method","POST"),a.getAttribute("action")!=o.url&&a.setAttribute("action",o.url),o.skipEncodingOverride||c.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),o.timeout&&setTimeout(function(){m=!0,r()},o.timeout);var s=[];try{if(o.extraData)for(var n in o.extraData)s.push(e('<input type="hidden" name="'+n+'" value="'+o.extraData[n]+'" />').appendTo(a)[0]);u.appendTo("body"),u.data("form-plugin-onload",r),a.submit()}finally{a.setAttribute("action",i),t?a.setAttribute("target",t):c.removeAttr("target"),e(s).remove()}}function r(){if(!p){var i=!0;try{if(m)throw"timeout";var s,a;a=d.contentWindow?d.contentWindow.document:d.contentDocument?d.contentDocument:d.document;var l=o.dataType=="xml"||a.XMLDocument||e.isXMLDoc(a);if(t("isXml="+l),!l&&(a.body==null||a.body.innerHTML==""))return--b?(t("requeing onLoad callback, DOM not available"),setTimeout(r,250),void 0):(t("Could not access iframe DOM after 100 tries."),void 0);if(t("response detected"),p=!0,f.responseText=a.body?a.body.innerHTML:null,f.responseXML=a.XMLDocument?a.XMLDocument:a,f.getResponseHeader=function(e){var t={"content-type":o.dataType};return t[e]},o.dataType=="json"||o.dataType=="script"){var h=a.getElementsByTagName("textarea")[0];if(h)f.responseText=h.value;else{var c=a.getElementsByTagName("pre")[0];c&&(f.responseText=c.innerHTML)}}else o.dataType!="xml"||f.responseXML||f.responseText==null||(f.responseXML=n(f.responseText));s=e.httpData(f,o.dataType)}catch(g){t("error caught:",g),i=!1,f.error=g,e.handleError(o,f,"error",g)}i&&(o.success(s,"success"),_&&e.event.trigger("ajaxSuccess",[f,o])),_&&e.event.trigger("ajaxComplete",[f,o]),_&&!--e.active&&e.event.trigger("ajaxStop"),o.complete&&o.complete(f,i?"success":"error"),setTimeout(function(){u.removeData("form-plugin-onload"),u.remove(),f.responseXML=null},100)}}function n(e,t){return window.ActiveXObject?(t=new ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(e)):t=(new DOMParser).parseFromString(e,"text/xml"),t&&t.documentElement&&t.documentElement.tagName!="parsererror"?t:null}var a=c[0];if(e(":input[name=submit]",a).length)return alert('Error: Form elements must not be named "submit".'),void 0;var o=e.extend({},e.ajaxSettings,i),l=e.extend(!0,{},e.extend(!0,{},e.ajaxSettings),o),h="jqFormIO"+(new Date).getTime(),u=e('<iframe id="'+h+'" name="'+h+'" src="'+o.iframeSrc+'" onload="(jQuery(this).data(\'form-plugin-onload\'))()" />'),d=u[0];u.css({position:"absolute",top:"-1000px",left:"-1000px"});var f={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(){this.aborted=1,u.attr("src",o.iframeSrc)}},_=o.global;if(_&&!e.active++&&e.event.trigger("ajaxStart"),_&&e.event.trigger("ajaxSend",[f,o]),l.beforeSend&&l.beforeSend(f,l)===!1)return l.global&&e.active--,void 0;if(!f.aborted){var p=!1,m=0,g=a.clk;if(g){var v=g.name;v&&!g.disabled&&(o.extraData=o.extraData||{},o.extraData[v]=g.value,g.type=="image"&&(o.extraData[v+".x"]=a.clk_x,o.extraData[v+".y"]=a.clk_y))}o.forceSync?s():setTimeout(s,10);var b=100}}if(!this.length)return t("ajaxSubmit: skipping submit process - no element selected"),this;typeof i=="function"&&(i={success:i});var r=e.trim(this.attr("action"));r&&(r=(r.match(/^([^#]+)/)||[])[1]),r=r||window.location.href||"",i=e.extend({url:r,type:this.attr("method")||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},i||{});var n={};if(this.trigger("form-pre-serialize",[this,i,n]),n.veto)return t("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(i.beforeSerialize&&i.beforeSerialize(this,i)===!1)return t("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var a=this.formToArray(i.semantic);if(i.data){i.extraData=i.data;for(var o in i.data)if(i.data[o]instanceof Array)for(var l in i.data[o])a.push({name:o,value:i.data[o][l]});else a.push({name:o,value:i.data[o]})}if(i.beforeSubmit&&i.beforeSubmit(a,this,i)===!1)return t("ajaxSubmit: submit aborted via beforeSubmit callback"),this;if(this.trigger("form-submit-validate",[a,this,i,n]),n.veto)return t("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;var h=e.param(a);i.type.toUpperCase()=="GET"?(i.url+=(0>i.url.indexOf("?")?"?":"&")+h,i.data=null):i.data=h;var c=this,u=[];if(i.resetForm&&u.push(function(){c.resetForm()}),i.clearForm&&u.push(function(){c.clearForm()}),!i.dataType&&i.target){var d=i.success||function(){};u.push(function(t){var s=i.replaceTarget?"replaceWith":"html";e(i.target)[s](t).each(d,arguments)})}else i.success&&u.push(i.success);i.success=function(e,t,s){for(var r=0,n=u.length;n>r;r++)u[r].apply(i,[e,t,s||c,c])};for(var f=e("input:file",this).fieldValue(),_=!1,p=0;f.length>p;p++)f[p]&&(_=!0);var m=!1;return f.length&&i.iframe!==!1||i.iframe||_||m?i.closeKeepAlive?e.get(i.closeKeepAlive,s):s():e.ajax(i),this.trigger("form-submit-notify",[this,i]),this},e.fn.ajaxForm=function(t){return this.ajaxFormUnbind().bind("submit.form-plugin",function(i){i.preventDefault(),e(this).ajaxSubmit(t)}).bind("click.form-plugin",function(t){var i=t.target,s=e(i);if(!s.is(":submit,input:image")){var r=s.closest(":submit");if(r.length==0)return;i=r[0]}var n=this;if(n.clk=i,i.type=="image")if(t.offsetX!=void 0)n.clk_x=t.offsetX,n.clk_y=t.offsetY;else if(typeof e.fn.offset=="function"){var a=s.offset();n.clk_x=t.pageX-a.left,n.clk_y=t.pageY-a.top}else n.clk_x=t.pageX-i.offsetLeft,n.clk_y=t.pageY-i.offsetTop;setTimeout(function(){n.clk=n.clk_x=n.clk_y=null},100)})},e.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")},e.fn.formToArray=function(t){var i=[];if(this.length==0)return i;var s=this[0],r=t?s.getElementsByTagName("*"):s.elements;if(!r)return i;for(var n=0,a=r.length;a>n;n++){var o=r[n],l=o.name;if(l)if(t&&s.clk&&o.type=="image")o.disabled||s.clk!=o||(i.push({name:l,value:e(o).val()}),i.push({name:l+".x",value:s.clk_x},{name:l+".y",value:s.clk_y}));else{var h=e.fieldValue(o,!0);if(h&&h.constructor==Array)for(var c=0,u=h.length;u>c;c++)i.push({name:l,value:h[c]});else h!==null&&h!==void 0&&i.push({name:l,value:h})}}if(!t&&s.clk){var d=e(s.clk),f=d[0],l=f.name;l&&!f.disabled&&f.type=="image"&&(i.push({name:l,value:d.val()}),i.push({name:l+".x",value:s.clk_x},{name:l+".y",value:s.clk_y}))}return i},e.fn.formSerialize=function(t){return e.param(this.formToArray(t))},e.fn.fieldSerialize=function(t){var i=[];return this.each(function(){var s=this.name;if(s){var r=e.fieldValue(this,t);if(r&&r.constructor==Array)for(var n=0,a=r.length;a>n;n++)i.push({name:s,value:r[n]});else r!==null&&r!==void 0&&i.push({name:this.name,value:r})}}),e.param(i)},e.fn.fieldValue=function(t){for(var i=[],s=0,r=this.length;r>s;s++){var n=this[s],a=e.fieldValue(n,t);a===null||a===void 0||a.constructor==Array&&!a.length||(a.constructor==Array?e.merge(i,a):i.push(a))}return i},e.fieldValue=function(e,t){var i=e.name,s=e.type,r=e.tagName.toLowerCase();if(t===void 0&&(t=!0),t&&(!i||e.disabled||s=="reset"||s=="button"||(s=="checkbox"||s=="radio")&&!e.checked||(s=="submit"||s=="image")&&e.form&&e.form.clk!=e||r=="select"&&e.selectedIndex==-1))return null;if(r=="select"){var n=e.selectedIndex;if(0>n)return null;for(var a=[],o=e.options,l=s=="select-one",h=l?n+1:o.length,c=l?n:0;h>c;c++){var u=o[c];if(u.selected){var d=u.value;if(d||(d=u.attributes&&u.attributes.value&&!u.attributes.value.specified?u.text:u.value),l)return d;a.push(d)}}return a}return e.value},e.fn.clearForm=function(){return this.each(function(){e("input,select,textarea",this).clearFields()})},e.fn.clearFields=e.fn.clearInputs=function(){return this.each(function(){var e=this.type,t=this.tagName.toLowerCase();e=="text"||e=="password"||t=="textarea"?this.value="":e=="checkbox"||e=="radio"?this.checked=!1:t=="select"&&(this.selectedIndex=-1)})},e.fn.resetForm=function(){return this.each(function(){(typeof this.reset=="function"||typeof this.reset=="object"&&!this.reset.nodeType)&&this.reset()})},e.fn.enable=function(e){return e==void 0&&(e=!0),this.each(function(){this.disabled=!e})},e.fn.selected=function(t){return t==void 0&&(t=!0),this.each(function(){var i=this.type;if(i=="checkbox"||i=="radio")this.checked=t;else if(this.tagName.toLowerCase()=="option"){var s=e(this).parent("select");t&&s[0]&&s[0].type=="select-one"&&s.find("option").selected(!1),this.selected=t}})}})(jQuery),$(document).ready(function(){deform.load()});var deform_loaded=!1,deform={callbacks:[],addCallback:function(e,t){deform.callbacks.push([e,t])},clearCallbacks:function(){deform.callbacks=[]},load:function(){$(function(){deform_loaded||(deform.processCallbacks(),deform.focusFirstInput(),deform_loaded=!0)})},processCallbacks:function(){$(deform.callbacks).each(function(e,t){var i=t[0],s=t[1];s(i)}),deform.clearCallbacks()},addSequenceItem:function(e,t){var i=/deformField(\d+)/,s=e.attr("prototype"),r=decodeURIComponent(s),n=$(r),a=n.find("[id]"),o=n.find("[name]"),l=deform.randomString(6),h={};a.each(function(e,t){var s=$(t),r=s.attr("id"),a=r.replace(i,"deformField$1-"+l);s.attr("id",a),h[r]=a;var o="label[for="+r+"]",c=n.find(o);c.attr("for",a)}),o.each(function(e,t){var s=$(t),r=s.attr("name"),n=r.replace(i,"deformField$1-"+l);s.attr("name",n)});var c=l+"-anchor",u='<a name="'+c+'" id="'+c+'"/>';$(u).insertBefore(t),n.insertBefore(t),$(deform.callbacks).each(function(e,t){var i=t[0],s=t[1],r=h[i];r&&s(r)}),deform.clearCallbacks();var d=parseInt(t.attr("now_len")||"0",10);t.attr("now_len",d+1)},appendSequenceItem:function(e){var t=$(e).parent(),i=t.children(".deformProto").first(),s=t.children("ul").first().children(".deformInsertBefore"),r=parseInt(s.attr("min_len")||"0",10),n=parseInt(s.attr("max_len")||"9999",10),a=parseInt(s.attr("now_len")||"0",10),o=parseInt(s.attr("orderable")||"0",10);return n>a&&(deform.addSequenceItem(i,s),deform.processSequenceButtons(t,r,n,a+1,o)),!1},removeSequenceItem:function(e){var t=$(e).parent(),i=t.parent().parent(),s=i.find(".deformInsertBefore").last(),r=parseInt(s.attr("min_len")||"0",10),n=parseInt(s.attr("max_len")||"9999",10),a=parseInt(s.attr("now_len")||"0",10),o=parseInt(s.attr("orderable")||"0",10);return a>r&&(s.attr("now_len",a-1),t.remove(),deform.processSequenceButtons(i,r,n,a-1,o)),!1},processSequenceButtons:function(e,t,i,s,r){var n=e.children("ul"),a=n.children("li");a.find(".deformClosebutton").removeClass("deformClosebuttonActive"),e.children(".deformSeqAdd").show(),s>t&&a.find(".deformClosebutton").addClass("deformClosebuttonActive"),i>s||e.children(".deformSeqAdd").hide(),r&&(s>1?a.find(".deformOrderbutton").addClass("deformOrderbuttonActive"):a.find(".deformOrderbutton").removeClass("deformOrderbuttonActive"))},maybeScrollIntoView:function(e){var t=$(window).width(),i=$(window).height(),s=$(document).scrollTop(),r=$(document).scrollLeft(),n=s,a=s+i,o=r,l=r+t,h=document.getElementById(e),c=$(e).offset();c.top>n&&a>c.top||c.left>o&&l>c.left||h.scrollIntoView()},focusFirstInput:function(e){e=e||document.body;var t=$(e).find(":input").filter("[id ^= deformField]").filter("[type != hidden]").first();if(t){var i=t.get(0);i&&(i.type==="text"||i.type==="file"||i.type=="password"||i.type=="text"||i.type=="textarea")&&i.className!="hasDatepicker"&&t.focus()}},randomString:function(e){var t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz";t=t.split(""),e||(e=Math.floor(Math.random()*t.length));for(var i="",s=0;e>s;s++)i+=t[Math.floor(Math.random()*t.length)];return i}};(function(e){var t=(e.browser.msie?"paste":"input")+".mask",i=window.orientation!=void 0;e.mask={definitions:{9:"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"},dataName:"rawMaskFn"},e.fn.extend({caret:function(e,t){if(this.length!=0){if(typeof e=="number")return t=typeof t=="number"?t:e,this.each(function(){if(this.setSelectionRange)this.setSelectionRange(e,t);else if(this.createTextRange){var i=this.createTextRange();i.collapse(!0),i.moveEnd("character",t),i.moveStart("character",e),i.select()}});if(this[0].setSelectionRange)e=this[0].selectionStart,t=this[0].selectionEnd;else if(document.selection&&document.selection.createRange){var i=document.selection.createRange();e=0-i.duplicate().moveStart("character",-1e5),t=e+i.text.length}return{begin:e,end:t}}},unmask:function(){return this.trigger("unmask")},mask:function(s,r){if(!s&&this.length>0){var n=e(this[0]);return n.data(e.mask.dataName)()}r=e.extend({placeholder:"_",completed:null},r);var a=e.mask.definitions,o=[],l=s.length,h=null,c=s.length;return e.each(s.split(""),function(e,t){t=="?"?(c--,l=e):a[t]?(o.push(RegExp(a[t])),h==null&&(h=o.length-1)):o.push(null)}),this.trigger("unmask").each(function(){function n(e){while(c>=++e&&!o[e]);return e}function u(e){while(--e>=0&&!o[e]);return e}function d(e,t){if(e>=0){for(var i=e,s=n(t);c>i;i++)if(o[i]){if(s>=c||!o[i].test(y[s]))break;y[i]=y[s],y[s]=r.placeholder,s=n(s)}g(),b.caret(Math.max(h,e))}}function f(e){for(var t=e,i=r.placeholder;c>t;t++)if(o[t]){var s=n(t),a=y[t];if(y[t]=i,s>=c||!o[s].test(a))break;i=a}}function _(e){var t=e.which;if(t==8||t==46||i&&t==127){var s=b.caret(),r=s.begin,a=s.end;return a-r==0&&(r=t!=46?u(r):a=n(r-1),a=t==46?n(a):a),m(r,a),d(r,a-1),!1}return t==27?(b.val(x),b.caret(0,v()),!1):void 0}function p(e){var t=e.which,i=b.caret();if(e.ctrlKey||e.altKey||e.metaKey||32>t)return!0;if(t){i.end-i.begin!=0&&(m(i.begin,i.end),d(i.begin,i.end-1));var s=n(i.begin-1);if(c>s){var a=String.fromCharCode(t);if(o[s].test(a)){f(s),y[s]=a,g();var l=n(s);b.caret(l),r.completed&&l>=c&&r.completed.call(b)}}return!1}}function m(e,t){for(var i=e;t>i&&c>i;i++)o[i]&&(y[i]=r.placeholder)}function g(){return b.val(y.join("")).val()}function v(e){for(var t=b.val(),i=-1,s=0,n=0;c>s;s++)if(o[s]){y[s]=r.placeholder;while(t.length>n++){var a=t.charAt(n-1);if(o[s].test(a)){y[s]=a,i=s;break}}if(n>t.length)break}else y[s]==t.charAt(n)&&s!=l&&(n++,i=s);return!e&&l>i+1?(b.val(""),m(0,c)):(e||i+1>=l)&&(g(),e||b.val(b.val().substring(0,i+1))),l?s:h}var b=e(this),y=e.map(s.split(""),function(e){return e!="?"?a[e]?r.placeholder:e:void 0}),x=b.val();b.data(e.mask.dataName,function(){return e.map(y,function(e,t){return o[t]&&e!=r.placeholder?e:null}).join("")}),b.attr("readonly")||b.one("unmask",function(){b.unbind(".mask").removeData(e.mask.dataName)}).bind("focus.mask",function(){x=b.val();var t=v();g();var i=function(){t==s.length?b.caret(0,t):b.caret(t)};(e.browser.msie?i:function(){setTimeout(i,0)})()}).bind("blur.mask",function(){v(),b.val()!=x&&b.change()}).bind("keydown.mask",_).bind("keypress.mask",p).bind(t,function(){setTimeout(function(){b.caret(v(!0))},0)}),v()})}})})(jQuery),function(){deform.appendSequenceItem=function(e){var t,i,s,r,n,a,o;return i=$(e).parent(),s=i.children(".deformProto").first(),t=i.children(".deformSeqContainer").first().children(".deformInsertBefore"),n=parseInt(t.attr("min_len")||"0",10),r=parseInt(t.attr("max_len")||"9999",10),a=parseInt(t.attr("now_len")||"0",10),o=parseInt(t.attr("orderable")||"0"),r>a&&(deform.addSequenceItem(s,t),deform.processSequenceButtons(i,n,r,a+1,o)),!1},deform.processSequenceButtons=function(e,t,i,s,r){var n,a;a=e.children(".deformSeqContainer"),n=a.children(".deformSeqItem"),n.children(".close").toggle(s>t),e.children(".deformSeqAdd").toggle(i>s),r&&(s>1?n.find(".deformOrderbutton").addClass("deformOrderbuttonActive"):n.find(".deformOrderbutton").removeClass("deformOrderbuttonActive"))}}.call(this),function(){var e;e=function(){function e(){this.options_index=0,this.parsed=[]}return e.prototype.add_node=function(e){return e.nodeName==="OPTGROUP"?this.add_group(e):this.add_option(e)},e.prototype.add_group=function(e){var t,i,s,r,n,a;for(t=this.parsed.length,this.parsed.push({array_index:t,group:!0,label:e.label,children:0,disabled:e.disabled}),n=e.childNodes,a=[],s=0,r=n.length;r>s;s++)i=n[s],a.push(this.add_option(i,t,e.disabled));return a},e.prototype.add_option=function(e,t,i){return e.nodeName==="OPTION"?(e.text!==""?(t!=null&&(this.parsed[t].children+=1),this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:e.value,text:e.text,html:e.innerHTML,selected:e.selected,disabled:i===!0?i:e.disabled,group_array_index:t,classes:e.className,style:e.style.cssText})):this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:!0}),this.options_index+=1):void 0},e}(),e.select_to_array=function(t){var i,s,r,n,a;for(s=new e,a=t.childNodes,r=0,n=a.length;n>r;r++)i=a[r],s.add_node(i);return s.parsed},this.SelectParser=e}.call(this),function(){var e,t;t=this,e=function(){function e(e,t){this.form_field=e,this.options=t!=null?t:{},this.set_default_values(),this.is_multiple=this.form_field.multiple,this.default_text_default=this.is_multiple?"Select Some Options":"Select an Option",this.setup(),this.set_up_html(),this.register_observers(),this.finish_setup()}return e.prototype.set_default_values=function(){var e=this;return this.click_test_action=function(t){return e.test_active_click(t)},this.activate_action=function(t){return e.activate_field(t)},this.active_field=!1,this.mouse_on_container=!1,this.results_showing=!1,this.result_highlighted=null,this.result_single_selected=null,this.allow_single_deselect=this.options.allow_single_deselect!=null&&this.form_field.options[0]!=null&&this.form_field.options[0].text===""?this.options.allow_single_deselect:!1,this.disable_search_threshold=this.options.disable_search_threshold||0,this.choices=0,this.results_none_found=this.options.no_results_text||"No results match"},e.prototype.mouse_enter=function(){return this.mouse_on_container=!0},e.prototype.mouse_leave=function(){return this.mouse_on_container=!1},e.prototype.input_focus=function(){var e=this;return this.active_field?void 0:setTimeout(function(){return e.container_mousedown()},50)},e.prototype.input_blur=function(){var e=this;return this.mouse_on_container?void 0:(this.active_field=!1,setTimeout(function(){return e.blur_test()},100))},e.prototype.result_add_option=function(e){var t,i;return e.disabled?"":(e.dom_id=this.container_id+"_o_"+e.array_index,t=e.selected&&this.is_multiple?[]:["active-result"],e.selected&&t.push("result-selected"),e.group_array_index!=null&&t.push("group-option"),e.classes!==""&&t.push(e.classes),i=e.style.cssText!==""?' style="'+e.style+'"':"",'<li id="'+e.dom_id+'" class="'+t.join(" ")+'"'+i+">"+e.html+"</li>")},e.prototype.results_update_field=function(){return this.result_clear_highlight(),this.result_single_selected=null,this.results_build()},e.prototype.results_toggle=function(){return this.results_showing?this.results_hide():this.results_show()},e.prototype.results_search=function(){return this.results_showing?this.winnow_results():this.results_show()},e.prototype.keyup_checker=function(e){var t,i;switch(t=(i=e.which)!=null?i:e.keyCode,this.search_field_scale(),t){case 8:if(this.is_multiple&&1>this.backstroke_length&&this.choices>0)return this.keydown_backstroke();if(!this.pending_backstroke)return this.result_clear_highlight(),this.results_search();break;case 13:if(e.preventDefault(),this.results_showing)return this.result_select(e);break;case 27:return this.results_showing&&this.results_hide(),!0;case 9:case 38:case 40:case 16:case 91:case 17:break;default:return this.results_search()}},e.prototype.generate_field_id=function(){var e;return e=this.generate_random_id(),this.form_field.id=e,e},e.prototype.generate_random_char=function(){var e,t,i;return e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZ",i=Math.floor(Math.random()*e.length),t=e.substring(i,i+1)},e}(),t.AbstractChosen=e}.call(this),function(){var e,t,i,s,r=Object.prototype.hasOwnProperty,n=function(e,t){function i(){this.constructor=e}for(var s in t)r.call(t,s)&&(e[s]=t[s]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};s=this,e=jQuery,e.fn.extend({chosen:function(i){return!e.browser.msie||e.browser.version!=="6.0"&&e.browser.version!=="7.0"?e(this).each(function(){return e(this).hasClass("chzn-done")?void 0:new t(this,i)}):this}}),t=function(t){function r(){r.__super__.constructor.apply(this,arguments)}return n(r,t),r.prototype.setup=function(){return this.form_field_jq=e(this.form_field),this.is_rtl=this.form_field_jq.hasClass("chzn-rtl")},r.prototype.finish_setup=function(){return this.form_field_jq.addClass("chzn-done")},r.prototype.set_up_html=function(){var t,s,r,n;return this.container_id=this.form_field.id.length?this.form_field.id.replace(/(:|\.)/g,"_"):this.generate_field_id(),this.container_id+="_chzn",this.f_width=this.form_field_jq.outerWidth(),this.default_text=this.form_field_jq.data("placeholder")?this.form_field_jq.data("placeholder"):this.default_text_default,t=e("<div />",{id:this.container_id,"class":"chzn-container"+(this.is_rtl?" chzn-rtl":""),style:"width: "+this.f_width+"px;"}),this.is_multiple?t.html('<ul class="chzn-choices"><li class="search-field"><input type="text" value="'+this.default_text+'" class="default" autocomplete="off" style="width:25px;" /></li></ul><div class="chzn-drop" style="left:-9000px;"><ul class="chzn-results"></ul></div>'):t.html('<a href="javascript:void(0)" class="chzn-single"><span>'+this.default_text+'</span><div><b></b></div></a><div class="chzn-drop" style="left:-9000px;"><div class="chzn-search"><input type="text" autocomplete="off" /></div><ul class="chzn-results"></ul></div>'),this.form_field_jq.hide().after(t),this.container=e("#"+this.container_id),this.container.addClass("chzn-container-"+(this.is_multiple?"multi":"single")),this.dropdown=this.container.find("div.chzn-drop").first(),s=this.container.height(),r=this.f_width-i(this.dropdown),this.dropdown.css({width:r+"px",top:s+"px"}),this.search_field=this.container.find("input").first(),this.search_results=this.container.find("ul.chzn-results").first(),this.search_field_scale(),this.search_no_results=this.container.find("li.no-results").first(),this.is_multiple?(this.search_choices=this.container.find("ul.chzn-choices").first(),this.search_container=this.container.find("li.search-field").first()):(this.search_container=this.container.find("div.chzn-search").first(),this.selected_item=this.container.find(".chzn-single").first(),n=r-i(this.search_container)-i(this.search_field),this.search_field.css({width:n+"px"})),this.results_build(),this.set_tab_index(),this.form_field_jq.trigger("liszt:ready",{chosen:this})},r.prototype.register_observers=function(){var e=this;return this.container.mousedown(function(t){return e.container_mousedown(t)}),this.container.mouseup(function(t){return e.container_mouseup(t)}),this.container.mouseenter(function(t){return e.mouse_enter(t)}),this.container.mouseleave(function(t){return e.mouse_leave(t)}),this.search_results.mouseup(function(t){return e.search_results_mouseup(t)}),this.search_results.mouseover(function(t){return e.search_results_mouseover(t)}),this.search_results.mouseout(function(t){return e.search_results_mouseout(t)}),this.form_field_jq.bind("liszt:updated",function(t){return e.results_update_field(t)}),this.search_field.blur(function(t){return e.input_blur(t)}),this.search_field.keyup(function(t){return e.keyup_checker(t)}),this.search_field.keydown(function(t){return e.keydown_checker(t)}),this.is_multiple?(this.search_choices.click(function(t){return e.choices_click(t)}),this.search_field.focus(function(t){return e.input_focus(t)})):this.container.click(function(e){return e.preventDefault()})},r.prototype.search_field_disabled=function(){return this.is_disabled=this.form_field_jq[0].disabled,this.is_disabled?(this.container.addClass("chzn-disabled"),this.search_field[0].disabled=!0,this.is_multiple||this.selected_item.unbind("focus",this.activate_action),this.close_field()):(this.container.removeClass("chzn-disabled"),this.search_field[0].disabled=!1,this.is_multiple?void 0:this.selected_item.bind("focus",this.activate_action))},r.prototype.container_mousedown=function(t){var i;return this.is_disabled?void 0:(i=t!=null?e(t.target).hasClass("search-choice-close"):!1,t&&t.type==="mousedown"&&t.stopPropagation(),this.pending_destroy_click||i?this.pending_destroy_click=!1:(this.active_field?this.is_multiple||!t||e(t.target)[0]!==this.selected_item[0]&&!e(t.target).parents("a.chzn-single").length||(t.preventDefault(),this.results_toggle()):(this.is_multiple&&this.search_field.val(""),e(document).click(this.click_test_action),this.results_show()),this.activate_field()))},r.prototype.container_mouseup=function(e){return e.target.nodeName==="ABBR"?this.results_reset(e):void 0},r.prototype.blur_test=function(){return!this.active_field&&this.container.hasClass("chzn-container-active")?this.close_field():void 0},r.prototype.close_field=function(){return e(document).unbind("click",this.click_test_action),this.is_multiple||(this.selected_item.attr("tabindex",this.search_field.attr("tabindex")),this.search_field.attr("tabindex",-1)),this.active_field=!1,this.results_hide(),this.container.removeClass("chzn-container-active"),this.winnow_results_clear(),this.clear_backstroke(),this.show_search_field_default(),this.search_field_scale()},r.prototype.activate_field=function(){return this.is_multiple||this.active_field||(this.search_field.attr("tabindex",this.selected_item.attr("tabindex")),this.selected_item.attr("tabindex",-1)),this.container.addClass("chzn-container-active"),this.active_field=!0,this.search_field.val(this.search_field.val()),this.search_field.focus()},r.prototype.test_active_click=function(t){return e(t.target).parents("#"+this.container_id).length?this.active_field=!0:this.close_field()},r.prototype.results_build=function(){var e,t,i,r,n;for(this.parsing=!0,this.results_data=s.SelectParser.select_to_array(this.form_field),this.is_multiple&&this.choices>0?(this.search_choices.find("li.search-choice").remove(),this.choices=0):this.is_multiple||(this.selected_item.find("span").text(this.default_text),this.form_field.options.length>this.disable_search_threshold?this.container.removeClass("chzn-container-single-nosearch"):this.container.addClass("chzn-container-single-nosearch")),e="",n=this.results_data,i=0,r=n.length;r>i;i++)t=n[i],t.group?e+=this.result_add_group(t):t.empty||(e+=this.result_add_option(t),t.selected&&this.is_multiple?this.choice_build(t):t.selected&&!this.is_multiple&&(this.selected_item.find("span").text(t.text),this.allow_single_deselect&&this.single_deselect_control_build()));return this.search_field_disabled(),this.show_search_field_default(),this.search_field_scale(),this.search_results.html(e),this.parsing=!1},r.prototype.result_add_group=function(t){return t.disabled?"":(t.dom_id=this.container_id+"_g_"+t.array_index,'<li id="'+t.dom_id+'" class="group-result">'+e("<div />").text(t.label).html()+"</li>")},r.prototype.result_do_highlight=function(e){var t,i,s,r,n;if(e.length){if(this.result_clear_highlight(),this.result_highlight=e,this.result_highlight.addClass("highlighted"),s=parseInt(this.search_results.css("maxHeight"),10),n=this.search_results.scrollTop(),r=s+n,i=this.result_highlight.position().top+this.search_results.scrollTop(),t=i+this.result_highlight.outerHeight(),t>=r)return this.search_results.scrollTop(t-s>0?t-s:0);if(n>i)return this.search_results.scrollTop(i)}},r.prototype.result_clear_highlight=function(){return this.result_highlight&&this.result_highlight.removeClass("highlighted"),this.result_highlight=null},r.prototype.results_show=function(){var e;return this.is_multiple||(this.selected_item.addClass("chzn-single-with-drop"),this.result_single_selected&&this.result_do_highlight(this.result_single_selected)),e=this.is_multiple?this.container.height():this.container.height()-1,this.dropdown.css({top:e+"px",left:0}),this.results_showing=!0,this.search_field.focus(),this.search_field.val(this.search_field.val()),this.winnow_results()},r.prototype.results_hide=function(){return this.is_multiple||this.selected_item.removeClass("chzn-single-with-drop"),this.result_clear_highlight(),this.dropdown.css({left:"-9000px"}),this.results_showing=!1},r.prototype.set_tab_index=function(){var e;return this.form_field_jq.attr("tabindex")?(e=this.form_field_jq.attr("tabindex"),this.form_field_jq.attr("tabindex",-1),this.is_multiple?this.search_field.attr("tabindex",e):(this.selected_item.attr("tabindex",e),this.search_field.attr("tabindex",-1))):void 0},r.prototype.show_search_field_default=function(){return this.is_multiple&&1>this.choices&&!this.active_field?(this.search_field.val(this.default_text),this.search_field.addClass("default")):(this.search_field.val(""),this.search_field.removeClass("default"))},r.prototype.search_results_mouseup=function(t){var i;return i=e(t.target).hasClass("active-result")?e(t.target):e(t.target).parents(".active-result").first(),i.length?(this.result_highlight=i,this.result_select(t)):void 0},r.prototype.search_results_mouseover=function(t){var i;return i=e(t.target).hasClass("active-result")?e(t.target):e(t.target).parents(".active-result").first(),i?this.result_do_highlight(i):void 0},r.prototype.search_results_mouseout=function(t){return e(t.target).hasClass("active-result")?this.result_clear_highlight():void 0},r.prototype.choices_click=function(t){return t.preventDefault(),!this.active_field||e(t.target).hasClass("search-choice")||this.results_showing?void 0:this.results_show()},r.prototype.choice_build=function(t){var i,s,r=this;return i=this.container_id+"_c_"+t.array_index,this.choices+=1,this.search_container.before('<li class="search-choice" id="'+i+'"><span>'+t.html+'</span><a href="javascript:void(0)" class="search-choice-close" rel="'+t.array_index+'"></a></li>'),s=e("#"+i).find("a").first(),s.click(function(e){return r.choice_destroy_link_click(e)})},r.prototype.choice_destroy_link_click=function(t){return t.preventDefault(),this.is_disabled?t.stopPropagation:(this.pending_destroy_click=!0,this.choice_destroy(e(t.target)))},r.prototype.choice_destroy=function(e){return this.choices-=1,this.show_search_field_default(),this.is_multiple&&this.choices>0&&1>this.search_field.val().length&&this.results_hide(),this.result_deselect(e.attr("rel")),e.parents("li").first().remove()},r.prototype.results_reset=function(t){return this.form_field.options[0].selected=!0,this.selected_item.find("span").text(this.default_text),this.show_search_field_default(),e(t.target).remove(),this.form_field_jq.trigger("change"),this.active_field?this.results_hide():void 0},r.prototype.result_select=function(e){var t,i,s,r;return this.result_highlight?(t=this.result_highlight,i=t.attr("id"),this.result_clear_highlight(),this.is_multiple?this.result_deactivate(t):(this.search_results.find(".result-selected").removeClass("result-selected"),this.result_single_selected=t),t.addClass("result-selected"),r=i.substr(i.lastIndexOf("_")+1),s=this.results_data[r],s.selected=!0,this.form_field.options[s.options_index].selected=!0,this.is_multiple?this.choice_build(s):(this.selected_item.find("span").first().text(s.text),this.allow_single_deselect&&this.single_deselect_control_build()),e.metaKey&&this.is_multiple||this.results_hide(),this.search_field.val(""),this.form_field_jq.trigger("change"),this.search_field_scale()):void 0},r.prototype.result_activate=function(e){return e.addClass("active-result")},r.prototype.result_deactivate=function(e){return e.text().startsWith("+ ")?e:e.removeClass("active-result")},r.prototype.result_deselect=function(t){var i,s;return s=this.results_data[t],s.selected=!1,this.form_field.options[s.options_index].selected=!1,i=e("#"+this.container_id+"_o_"+t),i.removeClass("result-selected").addClass("active-result").show(),this.result_clear_highlight(),this.winnow_results(),this.form_field_jq.trigger("change"),this.search_field_scale()
},r.prototype.single_deselect_control_build=function(){return this.allow_single_deselect&&1>this.selected_item.find("abbr").length?this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>'):void 0},r.prototype.winnow_results=function(){console.log("Chosen.prototype.winnow_results");var t,i,s,r,n,a,o,l,h,c,u,d,f,_,p,m,g;for(this.no_results_clear(),l=0,h=this.search_field.val()===this.default_text?"":e("<div/>").text(e.trim(this.search_field.val())).html(),n=RegExp("^"+h.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i"),d=RegExp(h.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i"),g=this.results_data,f=0,p=g.length;p>f;f++)if(i=g[f],!i.disabled&&!i.empty)if(i.group)e("#"+i.dom_id).css("display","none");else if(!this.is_multiple||!i.selected){if(t=!1,o=i.dom_id,a=e("#"+o),n.test(i.html))t=!0,l+=1;else if((i.html.indexOf(" ")>=0||i.html.indexOf("[")===0)&&(r=i.html.replace(/\[|\]/g,"").split(" "),r.length))for(_=0,m=r.length;m>_;_++)s=r[_],n.test(s)&&(t=!0,l+=1);t?(h.length?(c=i.html.search(d),u=i.html.substr(0,c+h.length)+"</em>"+i.html.substr(c+h.length),u=u.substr(0,c)+"<em>"+u.substr(c)):u=i.html,a.html(u),this.result_activate(a),i.group_array_index!=null&&e("#"+this.results_data[i.group_array_index].dom_id).css("display","list-item")):(this.result_highlight&&o===this.result_highlight.attr("id")&&this.result_clear_highlight(),this.result_deactivate(a))}return 1>l&&h.length?this.no_results(h):this.winnow_results_set_highlight()},r.prototype.winnow_results_clear=function(){var t,i,s,r,n;for(this.search_field.val(""),i=this.search_results.find("li"),n=[],s=0,r=i.length;r>s;s++)t=i[s],t=e(t),t.hasClass("group-result")?n.push(t.css("display","auto")):this.is_multiple&&t.hasClass("result-selected")?n.push(void 0):n.push(this.result_activate(t));return n},r.prototype.winnow_results_set_highlight=function(){var e,t;return this.result_highlight||(t=this.is_multiple?[]:this.search_results.find(".result-selected.active-result"),e=t.length?t.first():this.search_results.find(".active-result").first(),e==null)?void 0:this.result_do_highlight(e)},r.prototype.no_results=function(t){var i;return i=e('<li class="no-results">'+this.results_none_found+' "<span></span>"</li>'),i.find("span").first().html(t),this.search_results.append(i)},r.prototype.no_results_clear=function(){return this.search_results.find(".no-results").remove()},r.prototype.keydown_arrow=function(){var t,i;return this.result_highlight?this.results_showing&&(i=this.result_highlight.nextAll("li.active-result").first(),i&&this.result_do_highlight(i)):(t=this.search_results.find("li.active-result").first(),t&&this.result_do_highlight(e(t))),this.results_showing?void 0:this.results_show()},r.prototype.keyup_arrow=function(){var e;return this.results_showing||this.is_multiple?this.result_highlight?(e=this.result_highlight.prevAll("li.active-result"),e.length?this.result_do_highlight(e.first()):(this.choices>0&&this.results_hide(),this.result_clear_highlight())):void 0:this.results_show()},r.prototype.keydown_backstroke=function(){return this.pending_backstroke?(this.choice_destroy(this.pending_backstroke.find("a").first()),this.clear_backstroke()):(this.pending_backstroke=this.search_container.siblings("li.search-choice").last(),this.pending_backstroke.addClass("search-choice-focus"))},r.prototype.clear_backstroke=function(){return this.pending_backstroke&&this.pending_backstroke.removeClass("search-choice-focus"),this.pending_backstroke=null},r.prototype.keydown_checker=function(e){var t,i;switch(t=(i=e.which)!=null?i:e.keyCode,this.search_field_scale(),t!==8&&this.pending_backstroke&&this.clear_backstroke(),t){case 8:this.backstroke_length=this.search_field.val().length;break;case 9:this.results_showing&&!this.is_multiple&&this.result_select(e),this.mouse_on_container=!1;break;case 13:e.preventDefault();break;case 38:e.preventDefault(),this.keyup_arrow();break;case 40:this.keydown_arrow()}},r.prototype.search_field_scale=function(){var t,i,s,r,n,a,o,l,h;if(this.is_multiple){for(s=0,o=0,n="position:absolute; left: -1000px; top: -1000px; display:none;",a=["font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"],l=0,h=a.length;h>l;l++)r=a[l],n+=r+":"+this.search_field.css(r)+";";return i=e("<div />",{style:n}),i.text(this.search_field.val()),e("body").append(i),o=i.width()+25,i.remove(),o>this.f_width-10&&(o=this.f_width-10),this.search_field.css({width:o+"px"}),t=this.container.height(),this.dropdown.css({top:t+"px"})}},r.prototype.generate_random_id=function(){var t;t="sel"+this.generate_random_char()+this.generate_random_char()+this.generate_random_char();while(e("#"+t).length>0)t+=this.generate_random_char();return t},r}(AbstractChosen),i=function(e){var t;return t=e.outerWidth()-e.width()},s.get_side_border_padding=i}.call(this)