(function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e={}.hasOwnProperty,i=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},n=[].indexOf||function(t){for(var e=0,i=this.length;i>e;e++)if(e in this&&this[e]===t)return e;return-1};define("fabhub.view.location",function(e){var s,o,r,a;return s=function(e){function s(){return this.handle_geocode_search=t(this.handle_geocode_search,this),s.__super__.constructor.apply(this,arguments)}return i(s,e),s.prototype.selectors={address:"input[name=location]",lat_input:"input[name=lat]",lng_input:"input[name=lng]",ne_input:"input[name=ne]",sw_input:"input[name=sw]",country_input:"input[name=country_code]",region_input:"input[name=region_name]"},s.prototype._latlng=function(t){var e,i;if(t)return i=t.split(","),e=_.map(i,parseFloat),new google.maps.LatLng(e[0],e[1])},s.prototype.parse_geocoder_result=function(t){var e,i,s,o,r,a,l,h,d,c,u;for(s=t.geometry,i="",r="",c=t.address_components,a=0,h=c.length;h>a;a++)if(e=c[a],n.call(e.types,"country")>=0){i=e.short_name;break}for(u=t.address_components,l=0,d=u.length;d>l;l++)if(e=u[l],n.call(e.types,"administrative_area_level_1")>=0){r=e.long_name;break}return o={address:t.formatted_address,country_code:i,region_name:r,ne_str:s.viewport.getNorthEast().toUrlValue(),sw_str:s.viewport.getSouthWest().toUrlValue(),point_str:s.location.toUrlValue()}},s.prototype.handle_geocode_search=function(t,e){var i,n;return n=function(){var t,n,s;for(s=[],t=0,n=e.length;n>t;t++)i=e[t],s.push(this.parse_geocoder_result(i));return s}.call(this),t.process(n)},s.prototype.initialize=function(){var t=this;return this.model.bind("change",this.render),this.$address_input=this.$(this.selectors.address),this.$lat_input=this.$(this.selectors.lat_input),this.$lng_input=this.$(this.selectors.lng_input),this.$ne_input=this.$(this.selectors.ne_input),this.$sw_input=this.$(this.selectors.sw_input),this.$country_input=this.$(this.selectors.country_input),this.$region_input=this.$(this.selectors.region_input),this.geocoder=new google.maps.Geocoder,this.$address_input.typeahead({property:"address",source:function(e,i){return i?(t.geocoder.geocode({address:i},function(i,n){return n===google.maps.GeocoderStatus.OK?t.handle_geocode_search(e,i):void 0}),void 0):[]},onselect:function(e){return t.model.set(e)},matcher:function(){return!0},autoselect:!1}),this.model.set({address:this.$address_input.val(),point_str:""+this.$lat_input.val()+","+this.$lng_input.val()})},s}(Backbone.View),a=function(e){function n(){return this.render=t(this.render,this),this.handle_resize=t(this.handle_resize,this),n.__super__.constructor.apply(this,arguments)}return i(n,e),n.prototype.handle_resize=function(){return google.maps.event.trigger(this.map,"resize"),this.render()},n.prototype.render=function(){var t,e,i,n,s,o,r;return t=this.model.get("address"),t&&(this.$address_input.val(t),this.$address_input.trigger("change")),i=this._latlng(this.model.get("ne_str")),o=this._latlng(this.model.get("sw_str")),n=this._latlng(this.model.get("point_str")),e=this.model.get("country_code"),s=this.model.get("region_name"),i&&o&&n?(r=new google.maps.LatLngBounds(o,i),this.map.fitBounds(r),this.map.setCenter(n),this.marker.setPosition(n),this.$country_input.val(e),this.$lat_input.val(n.lat()),this.$lng_input.val(n.lng()),this.$region_input.val(s)):void 0},n.prototype.initialize=function(){var t,e,i,s,o,r,a,l;return n.__super__.initialize.call(this),this.$map_container=this.$("#location-map"),s=this.$map_container.get(0),o=new google.maps.LatLng(0,-180),r={mapTypeId:google.maps.MapTypeId.ROADMAP,disableDefaultUI:!0,disableDoubleClickZoom:!0,draggable:!1,keyboardShortcuts:!1,scrollwheel:!1,zoomControl:!1,zoom:12,center:o},this.options.map_styles!=null&&(r.styles=this.options.map_styles),this.map=new google.maps.Map(s,r),$(window).on("throttledresize",this.handle_resize),l="https://chart.googleapis.com/chart",e=""+l+"?chst=d_map_pin_letter&chld=%E2%80%A2|FE7569",a=new google.maps.Size(18,29),t=new google.maps.MarkerImage(e,null,null,null,a),i={draggable:!1,icon:t,map:this.map,position:o,title:"Location"},this.marker=new google.maps.Marker(i)},n}(s),r=function(e){function n(){return this.render=t(this.render,this),n.__super__.constructor.apply(this,arguments)}return i(n,e),n.prototype.selectors={address:"input[name=address]",lat_input:"input[name=lat]",lng_input:"input[name=lng]",ne_input:"input[name=ne_str]",sw_input:"input[name=sw_str]",country_input:"input[name=country_code]",region_input:"input[name=region_name]"},n.prototype.render=function(){var t,e;return t=this.model.get("address"),e=this._latlng(this.model.get("point_str")),t&&e?(this.$address_input.val(t),this.$lat_input.val(e.lat()),this.$lng_input.val(e.lng()),this.$ne_input.val(this.model.get("ne_str")),this.$sw_input.val(this.model.get("sw_str")),this.$country_input.val(this.model.get("country_code")),this.$region_input.val(this.model.get("region_name")),this.$address_input.trigger("change")):void 0},n}(s),o=function(e){function n(){return this.render=t(this.render,this),n.__super__.constructor.apply(this,arguments)}return i(n,e),n.prototype.render=function(){var t,e,i,n,s;return t=this.model.get("address"),e=this.model.get("country_code"),n=this.model.get("region_name"),i=this.model.get("ne_str"),s=this.model.get("sw_str"),t&&i&&s?(this.$ne_input.val(i),this.$sw_input.val(s),this.$country_input.val(e),this.$region_input.val(n),this.$address_input.val(t),this.$address_input.trigger("change")):void 0},n}(s),e.BaseLocationWidget=s,e.LocationWidget=a,e.LocationSearchWidget=r,e.LocationBoundsSearchWidget=o});var e={}.hasOwnProperty,i=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},t=function(t,e){return function(){return t.apply(e,arguments)}};define("fabhub.view.map",function(e){"         * render the alert with the (x) to clear filters        * provide progress feedback    ";var n,s,o,r,a,l,h;return $(function(){var t;return t=$(document.body),t.append('<script id="fabhub-view-map-info-window-template"                          type="text/template">                        <div>                          <div class="map-info-window">                            <%= info %>                          </div>                        </div>                      </script>')}),o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.idAttribute="path",e}(Backbone.GoogleMaps.Location),s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.model=o,e}(Backbone.GoogleMaps.LocationCollection),n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.template="#fabhub-view-map-info-window-template",e.prototype.overlayOptions={maxWidth:250},e}(Backbone.GoogleMaps.InfoWindow),h=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.infoWindow=n,e.prototype.overlayOptions={draggable:!1},e}(Backbone.GoogleMaps.MarkerView),l=function(e){function n(){return this.initialize=t(this.initialize,this),this.addChild=t(this.addChild,this),this.closeChild=t(this.closeChild,this),this.beforeRender=t(this.beforeRender,this),n.__super__.constructor.apply(this,arguments)}return i(n,e),n.prototype.defaults={bucket:"//s3-eu-west-1.amazonaws.com/thruflo-random-stuff",path:"/cluster-images/m",max_zoom:17,keepSpiderfied:!0,nearbyDistance:5,legWeight:1},n.prototype.markerView=h,n.prototype.beforeRender=function(){var t,e,i;return e={imagePath:""+this.options.bucket+this.options.path},t={maxZoom:this.options.max_zoom},i={keepSpiderfied:this.options.keepSpiderfied,nearbyDistance:this.options.nearbyDistance,legWeight:this.options.legWeight},this.spider=new OverlappingMarkerSpiderfier(this.map,i)},n.prototype.closeChild=function(t){var e,i;return i=t instanceof Backbone.Model?this.markerViewChildren[t.cid]:t,e=i.gOverlay,this.spider.removeMarker(e),n.__super__.closeChild.call(this,t)},n.prototype.addChild=function(t){var e,i,s;return n.__super__.addChild.call(this,t),s=this.markerViewChildren[t.cid],i=s.gOverlay,e=new google.maps.MarkerImage(t.get("icon_url")),i.setIcon(e),this.spider.addMarker(i)},n.prototype.initialize=function(){return this.options=_.defaults(this.options,this.defaults)},n}(Backbone.GoogleMaps.MarkerCollectionView),a=function(e){function n(){return this.resize_map_container=t(this.resize_map_container,this),this.handle_resize=t(this.handle_resize,this),this.handle_bounds_change=t(this.handle_bounds_change,this),this.handle_filter_change=t(this.handle_filter_change,this),this.handle_location_change=t(this.handle_location_change,this),this.handle_model_change=t(this.handle_model_change,this),this.handle_results=t(this.handle_results,this),this._zoom_if_necessary=t(this._zoom_if_necessary,this),this._do_query=t(this._do_query,this),this._latlng=t(this._latlng,this),n.__super__.constructor.apply(this,arguments)}return i(n,e),n.prototype.defaults={debounce_delay:850,map_height:.8,min_result_volume:6,min_zoom:3,max_zoom:19,query_endpoint:"/map",start_lat:0,start_lng:0,start_zoom:10,location_change_selectors:"input[name=location]",filter_change_selectors:".non-chosen-filter-change-selector",chosen_filter_targets:"select"},n.prototype._latlng=function(t){var e,i;if(t)return i=t.split(","),e=_.map(i,parseFloat),new google.maps.LatLng(e[0],e[1])},n.prototype._do_query=function(t){var e,i=this;return e={type:"POST",data:t,dataType:"json",success:this.handle_results,complete:function(){return i.$loading_indicator.fadeOut()}},$.ajax(this.options.query_endpoint,e)},n.prototype._zoom_if_necessary=function(t){var e,i,n,s,o,r;return e=this.collection.length,s=this.options.min_result_volume,s>e?(o=this.map.getZoom(),r=o-this.options.min_zoom,n=e?6:3,i=Math.ceil(r/n),this.map.setZoom(o-i),this._zoom_changed_the_bounds=t):void 0},n.prototype._handle_if_changed=function(t,e,i){var n,s,o;return n=$(e),o=n.val(),s=n.data("last-value"),s!=null&&s===n.val()?!1:(n.data("last-value",o),i(t))},n.prototype.handle_results=function(t){var e,i,n,s,o,r,a,l,h,d,c,u,p,_,m,g,f,y,v,w=this;a=[];for(r in t)p=t[r],$.isArray(p)&&a.push.apply(a,p);if(u=this.model.get("triggered_by"),h=u==="filter"||u==="location",this.collection.set(a,{remove:h}),s=t.appstruct.bounds,!s.ne){for(i=new google.maps.LatLngBounds,y=this.collection.models,_=0,g=y.length;g>_;_++)o=y[_],i.extend(o.getLatlng());return this.map.fitBounds(i),void 0}for(i=new google.maps.LatLngBounds,v=["ne","sw"],m=0,f=v.length;f>m;m++)o=v[m],i.extend(this._latlng(s[o]));return n=i.toUrlValue()!==this.map.getBounds().toUrlValue(),u=this.model.get("triggered_by"),l=u==="location",d=u==="location",c=u!=="bounds",l&&n?(this._we_changed_the_bounds=!0,this.map.fitBounds(i),e=google.maps.event.addListenerOnce,e(this.map,"bounds_changed",function(){return c&&w._zoom_if_necessary(d),w._we_changed_the_bounds=!1})):c?this._zoom_if_necessary(d):void 0},n.prototype.handle_model_change=function(){return this._do_query(this.model.get("data"))},n.prototype.handle_location_change=function(){var t;return t={data:this.$form.serialize(),triggered_by:"location"},this.model.set(t),this.$loading_indicator.fadeIn(),!1},n.prototype.handle_filter_change=function(){var t;return t={data:this.$form.serialize(),triggered_by:"filter"},this.model.set(t),!1},n.prototype.handle_bounds_change=function(){var t,e,i,n,s,o,r,a,l,h,d,c;if(s=this.map.getBounds(),o=s.toUrlValue(),r=this._stored_bounds.toUrlValue(),e=o===r,this._stored_bounds=s,this._we_changed_the_bounds)return this._we_changed_the_bounds=!1,!1;if(l="bounds",this._zoom_changed_the_bounds&&(l="zoom",this._zoom_changed_the_bounds=!1),e)return!1;for(t={ne:s.getNorthEast().toUrlValue(),sw:s.getSouthWest().toUrlValue()},this.$ne_input.val(t.ne),this.$sw_input.val(t.sw),a=[],c=this.$form.serializeArray(),h=0,d=c.length;d>h;h++)n=c[h],n.name in t&&(n.value=t[n.name]),a.push(n);return i=$.param(a),this.model.set({data:i,triggered_by:l}),!1},n.prototype.handle_resize=function(){var t;return t=this.map.getCenter(),this.resize_map_container(),google.maps.event.trigger(this.map,"resize"),t!=null?this.map.setCenter(t):void 0},n.prototype.resize_map_container=function(){var t,e;return e=$(window),t=this.$map_container.closest("div"),t.height(parseInt(e.height()*this.options.map_height))},n.prototype.initialize=function(){var t,e,i,n,o,r,a,h,d,c,u,p,m,g=this;return this.options=_.defaults(this.options,this.defaults),this.$form=$(this.el),this.$map_container=$(this.options.map),this.$ne_input=this.$("input[name=ne]"),this.$sw_input=this.$("input[name=sw]"),this.$loading_indicator=$("#map-loading-indicator"),this.$ne_input.val(""),this.$sw_input.val(""),a=this._handle_if_changed,d=this.handle_location_change,h=this.handle_filter_change,n=this.$(this.options.location_change_selectors),n.change(function(t){return a(t,this,d)}),i=this.$(this.options.filter_change_selectors),i.change(function(t){return a(t,this,h)}),e=this.$(this.options.chosen_filter_targets),t=e.chosen({allow_single_deselect:!0}),t.change(function(t){return a(t,this,h)}),this.$form.submit(this.handle_filter_change),this.resize_map_container(),p=this.$map_container.get(0),c=this.options.start_lat,u=this.options.start_lng,m={center:new google.maps.LatLng(c,u),draggable:!0,mapTypeControl:!1,mapTypeId:google.maps.MapTypeId.ROADMAP,maxZoom:this.options.max_zoom,minZoom:this.options.min_zoom,scrollwheel:!1,zoom:this.options.start_zoom},this.options.map_styles!=null&&(m.styles=this.options.map_styles),this.options.map_bg!=null&&(m.backgroundColor=this.options.map_bg),google.maps.visualRefresh=!0,this.map=new google.maps.Map(p,m),this.collection=new s,this.listing=new l({collection:this.collection,map:this.map,max_zoom:this.options.max_zoom-2}),this.listing.render(),o=google.maps.event.addListener,r=google.maps.event.addListenerOnce,r(this.map,"bounds_changed",function(){var t,e;return t=g.options.debounce_delay,e=_.debounce(g.handle_bounds_change,t),o(g.map,"bounds_changed",e),g._stored_bounds=g.map.getBounds(),g._do_query(g.$form.serialize()),!1}),$(window).on("throttledresize",this.handle_resize),this.model.on("change",this.handle_model_change)},n}(Backbone.View),r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.initialize=function(){var t,e,i,n,s,o,r;return e=this.$("input[name=location]"),e.attr({autocomplete:"off"}),n=this.$("#search-form input[type=submit]"),n.hide(),t=e.closest("form"),r=new fabhub.view.location.LocationBoundsSearchWidget({el:t,model:new Backbone.Model}),i=this.$("#map"),s={el:t,map:i,model:new Backbone.Model,map_styles:this.options.map_styles},this.options.map_height!=null&&(s.map_height=this.options.map_height),o=new a(s)},e}(Backbone.View),e.MapCollection=s,e.MarkerListing=l,e.MapPage=r,e.MapView=a});var t=function(t,e){return function(){return t.apply(e,arguments)}},e={}.hasOwnProperty,i=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t};define("opendesk.controller",function(e){var n,s;return n=function(e){function n(){return this.initialize=t(this.initialize,this),this.wall=t(this.wall,this),this.raise_exception=t(this.raise_exception,this),this.view_order=t(this.view_order,this),this.place_order=t(this.place_order,this),this.quote_requests_map=t(this.quote_requests_map,this),this.get_regions=t(this.get_regions,this),this.map=t(this.map,this),this.makers=t(this.makers,this),this.designs=t(this.designs,this),this.your_requirements=t(this.your_requirements,this),this.get_it_made=t(this.get_it_made,this),this.download=t(this.download,this),this.your_opendesk=t(this.your_opendesk,this),this.get_it=t(this.get_it,this),this.design=t(this.design,this),this.index=t(this.index,this),n.__super__.constructor.apply(this,arguments)}return i(n,e),n.prototype.use_path_exp=/^[.\w-]{1,64}\/([.\w-]{1,64})\/(([a-z0-9]{28})|([0-9]){1,14})\/?$/,n.prototype.routes={"":"index",designs:"designs","designs/":"designs",makers:"makers","makers/":"makers",map:"map","map/":"map","get-regions":"get_regions","get-regions/":"get_regions",order:"place_order","order/":"place_order","orders/:order":"view_order","orders/:order/":"view_order","quote-requests-map/a8b1d02f8d8d3358":"quote_requests_map","quote-requests-map/a8b1d02f8d8d3358/":"quote_requests_map",raise_exception:"raise_exception","raise_exception/":"raise_exception",wall:"wall","wall/":"wall",":range/:design":"design",":range/:design/":"design",":range/:design/get-it":"get_it",":range/:design/get-it/:mode(/:form)":"get_it",":range/:design/get-it/:mode/(:form/)":"get_it",":range/:design/your-requirements":"your_requirements",":range/:design/your-requirements/":"your_requirements"},n.prototype.index=function(){return new opendesk.view.index.IndexPage({el:$(document.body),model:new Backbone.Model})},n.prototype.design=function(t){return typeof opendesk_design_range!="undefined"&&opendesk_design_range!==null&&t===opendesk_design_range?new opendesk.view.design.DesignPage({el:$(document.body),model:new Backbone.Model}):void 0},n.prototype.get_it=function(t,e,i,n){var s;return s={mode:i,form:n},this.get_it_view==null?(s=_.extend(s,opendesk.bootstrap),this.get_it_model=new Backbone.Model(s),this.get_it_view=new opendesk.view.get_it.GetItPage({el:$(document.body),model:this.get_it_model})):this.get_it_model.set(s)},n.prototype.your_opendesk=function(){var t;return t=new opendesk.view.use.YourOpenDeskPage({el:$(document.body),model:new Backbone.Model,collection:new Backbone.Collection})},n.prototype.download=function(){return new opendesk.view.design.DownloadPage({el:$(document.body),model:new Backbone.Model})},n.prototype.get_it_made=function(){return new opendesk.view.product.GetItMadePage({el:$(document.body),model:new Backbone.Model})},n.prototype.your_requirements=function(){return new opendesk.view.design.CustomisePage({el:$(document.body),model:new Backbone.Model})},n.prototype.designs=function(){return new opendesk.view.design.DesignsListingPage({el:$(document.body),model:new Backbone.Model})},n.prototype.makers=function(){return new opendesk.view.maker.MakersListingPage({el:$(document.body),model:new Backbone.Model})},n.prototype.map=function(){return new opendesk.view.location.MapPage({el:$(document.body),model:new Backbone.Model,map_styles:opendesk.style.map_styles,map_height:.7})},n.prototype.get_regions=function(){return new opendesk.view.location.GetRegionsPage({el:$(document.body),model:new Backbone.Model})},n.prototype.quote_requests_map=function(){return new opendesk.view.location.QuoteRequestsMapPage({el:$(document.body),model:new Backbone.Model})},n.prototype.place_order=function(){return new opendesk.view.order.PlaceOrderPage({el:$(document.body),model:new Backbone.Model})},n.prototype.view_order=function(){return new opendesk.view.order.ViewOrderPage({el:$(document.body),model:new Backbone.Model})},n.prototype.raise_exception=function(){throw Error("Test raising javascript exception.")},n.prototype.wall=function(){return new opendesk.view.wall.WallPage({el:$(document.body),model:new Backbone.Model})},n.prototype.initialize=function(){return this.route(this.use_path_exp,"your_opendesk")},n}(Backbone.Router),s=function(){var t,i,s,o,r,a;return $(".carousel").carousel({interval:7e3}),t=$("#js-super-proposition"),$(".navbar-pristine").affix({offset:{top:function(){return t.outerHeight()}}}),$(".subscribe-widget").each(function(){return new opendesk.subscribe.SubscribeWidget({el:$(this)})}),$(".js-simple-feedback").each(function(){return new opendesk.view.feedback.SimpleFeedbackWidget({el:$(this)})}),new opendesk.circa_price.CircaPriceListing({el:$('[data-provides="circa-price"]')}),i=new n,e.navigate=i.navigate,(typeof pyramid_weblayer_is_exception_view=="undefined"||pyramid_weblayer_is_exception_view===null)&&(o={pushState:Modernizr.history,silent:!0},Backbone.history.start(o),Modernizr.history?Backbone.history.loadUrl(Backbone.history.getFragment()):(a=Backbone.history.options.root.length,s=window.location.pathname.substr(a),Backbone.history.navigate(s,{trigger:!0}))),location.hash==="#_=_"?history.pushState!=null?(r=location.pathname+location.search,history.pushState("",document.title,r)):location.hash="":void 0},e.main=s}),$(function(){return opendesk.controller.main()}),$(function(){var t,e,i,n,s,o,r,a,l;return t=$(document.body),window.WebGLRenderingContext||t.addClass("no-webgl"),$(".display-datetime").humaneDates(),e=$(".navbar"),i=$(".navbar > .container"),n=$(".navbar-inner"),o=$(window),r=function(){var t,i,n;return i=o.scrollTop(),i>0&&(n=e.css("position"),t=n==="fixed")?(e.addClass("scrolled"),void 0):e.removeClass("scrolled")},o.on("scroll",r),r(),a=function(){return n.css("maxWidth",i.width())},l=window.setInterval(function(){return n.width()>e.width()?(window.clearInterval(l),window.setInterval(a,1e3),a()):void 0},2e3),$("img[data-fallback]").each(function(){var t,e,i;return t=$(this),i=t.data("src"),e=t.data("fallback"),t.one("error",function(){return $(this).attr({src:e})}),t.attr({src:i})}),s=$('[data-dismiss="fileinput"]'),s.on("click.fileinput",function(t){return t.preventDefault(),!0})});var e={}.hasOwnProperty,i=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t};define("opendesk.subscribe",function(t){var e;return e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.initialize=function(){var t,e,i,n,s,o,r,a,l;return a=this.$el,n=this.$("li:first-child"),s=this.$("li:first-child a:first-child"),t=this.$(".subscribe-hide"),i=this.$("form"),e=this.$("input[name=email]"),r=this.$("input[name=section]"),o=this.$("a.success-message"),i.hide(),o.hide(),i.removeClass("hide"),o.removeClass("hide"),l=function(){var e,n,l;return i.removeClass("has-error"),e={section:r.val()},n=JSON.stringify(e),l={type:"POST",data:n,dataType:"json",success:function(){return o.show(),a.removeClass("showing-form"),i.hide(),s.hide(),t.hide()},error:function(e){return a.addClass("showing-form"),i.show(),e.status===400&&i.addClass("has-error"),o.hide(),s.hide(),t.hide()}},$.ajax("/api/v1/subscriptions",l)},s.click(function(){return l(),!1}),i.submit(function(){var t,i;return t={email:e.val(),can_create_user:!0},i={type:"POST",data:t,success:function(){return l()},error:function(){return window.location.href="/open/auth/signin"}},$.ajax("/api/v1/auth/authenticate",i),!1})},e}(Backbone.View),t.SubscribeWidget=e}),define("opendesk.util",function(t){var e,i,n,s,o,r,a,l,h;return e=_.extend({},Backbone.Events),h="GBP",n={GBP:{format:"%s%v",precision:0,symbol:"£"},USD:{format:"%s%v",precision:0,symbol:"$"},EUR:{format:"%s%v",precision:0,symbol:"€"}},i=function(t,e,i){var n,s;return(n=t!=null&&e!=null&&i!=null)?(s={from:e,to:i},fx.convert(t,s)):t!=null?t:0},s=function(t,e){var i;return t==null?"":(e==null&&(e=h),i=e in n?n[e]:{format:"%v %s",precision:0,symbol:e},accounting.formatMoney(t,i))},l=function(t,e){var i,n;return n={name:e},i=_.findWhere(t,n),i.value},o=function(t,e,i){var n,s;return s={name:e},n=_.findWhere(t,s),n.value||(n.value=i),t},r=function(){return""+window.location.protocol+"//"+window.location.host+"/"+(""+Backbone.history.options.root+Backbone.history.getFragment())},a=function(){return""+Backbone.history.options.root+Backbone.history.getFragment()},t.broadcaster=e,t.currency_convert=i,t.display_price=s,t.ensure_named_param_value=o,t.get_location_href=r,t.get_location_path=a,t.get_named_param_value=l,t.local_currency=h});var t=function(t,e){return function(){return t.apply(e,arguments)}},e={}.hasOwnProperty,i=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t};define("opendesk.circa_price",function(e){var n,s;return s=opendesk.util.display_price,n=function(e){function n(){return this.handle=t(this.handle,this),n.__super__.constructor.apply(this,arguments)}return i(n,e),n.prototype.ids={},n.prototype.targets=[],n.prototype.handle=function(t){var e,i,n,o,r,a,l,h,d,c;for(i=t.circa_prices,d=this.targets,c=[],l=0,h=d.length;h>l;l++)r=d[l],r.id in i&&!(e=i[r.id])||(o=e.min_quantity>1,n="for "+e.min_quantity,a=e.min_quantity*e.value,r.el.html('c.\n<span class="price">\n  '+s(a,e.currency)+"</span>\n"+(o?n:"")),r.el.removeClass("hide"),c.push(r.el.show()));return c},n.prototype.initialize=function(){var t,e,i,n=this;return this.$el.each(function(t,e){var i,s,o,r;return i=$(e),o=i.data("circa-price-id"),r=""+o,s=i.data("circa-price-target"),n.ids[r]=!0,n.targets.push({id:r,el:i.find(s)})}),e=_.keys(this.ids),e.length?(i="/api/v1/designs/circa_prices",t={ids:_.keys(this.ids).join(",")},$.getJSON(i,t,this.handle)):void 0},n}(Backbone.View),e.CircaPriceListing=n});var e={}.hasOwnProperty,i=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},t=function(t,e){return function(){return t.apply(e,arguments)}};define("opendesk.view.base",function(e){var n,s;return s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.initialize=function(){return this.listenTo(this.model,"change",this.render),this.model.view=this,this.render()},e}(Backbone.View),n=function(e){function n(){return this.reset=t(this.reset,this),this.remove=t(this.remove,this),this.add=t(this.add,this),n.__super__.constructor.apply(this,arguments)}var o;return i(n,e),o=s,n.prototype.add=function(t){var e;return e=new this.widget_cls({model:t}),this.$el.append(e.$el)},n.prototype.remove=function(t){return t.view.remove()},n.prototype.reset=function(t,e){var i,n,s,o;for(o=e.previousModels,n=0,s=o.length;s>n;n++)i=o[n],this.remove(i);return this.collection.each(this.add)},n.prototype.initialize=function(){return this.listenTo(this.collection,"add",this.add),this.listenTo(this.collection,"reset",this.reset),this.listenTo(this.collection,"remove",this.remove),this.collection.each(this.add)},n}(Backbone.View),e.BaseListing=n,e.BaseWidget=s});var e={}.hasOwnProperty,i=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t};define("opendesk.view.design",function(t){var e,n,s,o;return s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.initialize=function(){return new opendesk.view.location.SupportedLocationWidget({el:this.el})},e}(Backbone.View),n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.initialize=function(){var t,e,i,n,s,o;return n=this.$("#map"),i=this.$("#map-form"),t=this.$("#recent-downloads-section .js-explore-download-map"),e=this.$(".js-explore-download-map"),e.click(function(){return this.map_view==null&&(this.map_view=new fabhub.view.map.MapView({el:i,map:n,model:new Backbone.Model,map_styles:opendesk.style.map_styles,map_height:.7,map_bg:"#F9F9FA",min_zoom:2}),t.css({visibility:"hidden",width:"1px"})),$.scrollTo("#recent-downloads-section",{offset:-72}),!1}),/explore_download_map/.test(window.location.search)&&e.click(),s=$("#viewer-iframe"),o=$("#sketchfab-modal"),o.on("shown",function(){var t;return t={command:"start"},s.get(0).contentWindow.postMessage(t,"*")}),o.on("hide",function(){var t;return t={command:"stop"},s.get(0).contentWindow.postMessage(t,"*")})},e}(Backbone.View),o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.initialize=function(){var t,i,n;return e.__super__.initialize.call(this),i=this.$("input[name=location]"),i.attr({autocomplete:"off"}),i.after('<div id="location-map" class="input-xlarge clearfix"></div>'),t=i.parents("form"),n=new fabhub.view.location.LocationWidget({el:t,model:new Backbone.Model,map_styles:opendesk.style.map_styles}),i.focus(function(){var t;return t=$("#location-map"),t.slideDown("slow",function(){return n.handle_resize()})})},e}(n),e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e}(o),t.DesignsListingPage=s,t.DesignPage=n,t.DownloadPage=o,t.CustomisePage=e});var t=function(t,e){return function(){return t.apply(e,arguments)}},e={}.hasOwnProperty,i=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},s=[].slice;define("opendesk.view.feedback",function(e){var n;return n=function(e){function n(){return this.refresh=t(this.refresh,this),this.handle_success=t(this.handle_success,this),this.handle_error=t(this.handle_error,this),this.handle_submit=t(this.handle_submit,this),n.__super__.constructor.apply(this,arguments)}return i(n,e),n.prototype.events={submit:"handle_submit"},n.prototype.handle_submit=function(){var t,e,i,n;return this.$form.removeClass("has-error"),this.$help.text(""),this.$help.hide(),t=this.$form.attr("action"),e=this.$form.serialize(),i=typeof opendesk!="undefined"&&opendesk!==null&&opendesk.util!=null&&opendesk.util.get_location_href!=null?opendesk.util.get_location_href():window.location.href,e+="&url="+i,n={type:"POST",data:e,dataType:"json",error:this.handle_error,success:this.handle_success},$.ajax(t,n),!1},n.prototype.handle_error=function(){var t;return t=1>arguments.length?[]:s.call(arguments,0),this.$form.addClass("has-error"),this.$help.text("Failed to post your feedback. Please try again."),this.$help.show()},n.prototype.handle_success=function(){return this.$input.val(""),this.$form.hide(),this.$alert.show(),window.setTimeout(this.refresh,8e3)},n.prototype.refresh=function(){var t=this;return this.$alert.fadeOut(800,function(){return t.$form.fadeIn(500)})},n.prototype.initialize=function(){return this.$alert=this.$(".alert"),this.$alert.hide(),this.$alert.removeClass("hide"),this.$form=this.$("form"),this.$help=this.$(".help-block"),this.$input=this.$("input[name=feedback]"),this.$input.val("")},n}(Backbone.View),e.SimpleFeedbackWidget=n});var t=function(t,e){return function(){return t.apply(e,arguments)}},e={}.hasOwnProperty,i=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},n=[].indexOf||function(t){for(var e=0,i=this.length;i>e;e++)if(e in this&&this[e]===t)return e;return-1};define("opendesk.view.get_it",function(e){var s,o,r,a,l,h,d,c,u,p,m,g,f,y,v,w,b,k,z,x,q,B;return b=opendesk.util.broadcaster,z=opendesk.util.get_named_param_value,k=opendesk.util.ensure_named_param_value,a=function(e){function n(){return this.get_quote=t(this.get_quote,this),n.__super__.constructor.apply(this,arguments)}return i(n,e),n.prototype.idAttribute="path",n.prototype.get_quote=function(t){var e,i,n,s;if(this.has("quotes"))for(s=this.get("quotes"),i=0,n=s.length;n>i;i++)if(e=s[i],e.product===t.get("slug"))return e},n}(Backbone.Model),p=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.idAttribute="path",e}(Backbone.Model),l=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.model=a,e}(Backbone.Collection),m=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.model=p,e}(Backbone.Collection),s=function(e){function n(){return this.handle_select=t(this.handle_select,this),this.render=t(this.render,this),n.__super__.constructor.apply(this,arguments)}var s;return i(n,e),s=null,n.prototype.states={active:"active",hidden:"hidden",inactive:"inactive",selected:"selected"},n.prototype.render=function(){return this.$el.html(this.template(this.model.attributes))
},n.prototype.handle_select=function(){if(this.model.get("state"!==this.states.active))return!1;try{b.trigger(""+this.content_type+":selected",this.model)}catch(t){typeof console!="undefined"&&console!==null&&console.error!=null&&console.error(t)}return!1},n.prototype.initialize=function(){return n.__super__.initialize.call(this),this.$el.click(this.handle_select)},n}(opendesk.view.base.BaseWidget),x='<div class="result <%= content_type %> <%= state %>">\n  <%= tmpl %>\n</div>',d=function(e){function n(){return this.handle_product_selected=t(this.handle_product_selected,this),this.handle_maker_selected=t(this.handle_maker_selected,this),this.render=t(this.render,this),n.__super__.constructor.apply(this,arguments)}return i(n,e),n.prototype.className="col-xs-12",n.prototype.content_type="maker",n.prototype.template=_.template(x),n.prototype.render=function(){var t,e;return n.__super__.render.call(this),e=this.model.get("price"),e?(t=this.$(".result-price-label"),t.text(e)):void 0},n.prototype.handle_maker_selected=function(t){var e;return e=this.model.get("state"),this.model===t&&e===this.states.active&&this.model.set("state",this.states.selected),this.model!==t&&e===this.states.selected?this.model.set("state",this.states.active):void 0},n.prototype.handle_product_selected=function(t){var e,i,n,s,o,r,a;return r=this.model.get_quote(t),r==null?i={state:this.states.hidden}:(e=this.states.active,a=this.states.selected,n=this.model.get("state"),o=n===a?a:e,s=opendesk.util.display_price,i={price:s(r.value,r.currency),state:o}),this.model.set(i)},n.prototype.initialize=function(){var t;return t={content_type:this.content_type,price:null,state:this.states.inactive},this.model.set(t),this.listenTo(b,"maker:selected",this.handle_maker_selected),this.listenTo(b,"product:selected",this.handle_product_selected),n.__super__.initialize.call(this)},n}(s),B='<div class="result <%= content_type %> <%= state %>">\n  <%= tmpl %>\n</div>',y=function(e){function n(){return this.handle_product_selected=t(this.handle_product_selected,this),this.handle_maker_selected=t(this.handle_maker_selected,this),n.__super__.constructor.apply(this,arguments)}return i(n,e),n.prototype.className="col-xs-4",n.prototype.content_type="product",n.prototype.template=_.template(B),n.prototype.handle_maker_selected=function(){},n.prototype.handle_product_selected=function(t){var e;return e=t===this.model?this.states.selected:this.states.active,this.model.set("state",e)},n.prototype.initialize=function(){var t;return t={content_type:this.content_type,state:this.states.active},this.model.set(t),this.listenTo(b,"maker:selected",this.handle_maker_selected),this.listenTo(b,"product:selected",this.handle_product_selected),n.__super__.initialize.call(this)},n}(s),h=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.widget_cls=d,e}(opendesk.view.base.BaseListing),g=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.widget_cls=y,e}(opendesk.view.base.BaseListing),w=function(e){function n(){return this.initialize=t(this.initialize,this),this.render=t(this.render,this),this.error=t(this.error,this),n.__super__.constructor.apply(this,arguments)}var s;return i(n,e),s=null,n.prototype.error=function(){var t;return t=this.$img.get(0),this.$el.stop(!0,!1),this.$el.hide(),this.$img.hide()},n.prototype.render=function(t){var e,i,n,s,o,r=this;return e=this.model.get("design_slug"),n=t.get("material_description"),i=n.toLowerCase().replace(" ","-"),s=""+e+"/renders/"+e+"-"+i+".png",o=assetgen.static_url("opendesk:assets/gfx/designs/"+s),o!==this._last_src?(this.$el.fadeOut(150,function(){return r.$img.show(),r.$img.attr({src:o}),r.$el.fadeIn(350),r.$modal_description.text(n),r.$modal_image.attr({src:o})}),this._last_src=o):void 0},n.prototype.initialize=function(){return this.$img=this.$("img"),this.$img.error(this.error),this.$modal_description=$("#render-modal .modal-material-description"),this.$modal_image=$("#render-modal .modal-render-image"),this.listenTo(b,"product:selected",this.render)},n}(Backbone.View),q='<div class="<%= state %>">\n  <h3 class="first-heading">\n    Cost: <%- total_price %>\n  </h3>\n  <p>\n    <%- quantity %> x\n    <%- product !== null ? form_name.toLowerCase() : \'\' %>\n    <%- design_name %>\n    <%- product !== null ? (\'in \' + product.get(\'material_description\')) : \'\' %>\n    <%- maker !== null ? (\'by \' + maker.get(\'name\')) : \'\' %>\n  </p>\n  <div class="action-menu" id="add-to-basket-link">\n    <p class="visible-xs">\n      <a class="btn btn-lg btn-block <%= state == \'ready\' ? \' \' : \'disabled\' %>"\n          href="add-to-basket">\n        <span class="glyphicon glyphicon-shopping-cart"></span>\n        &nbsp; Add to basket&nbsp;\n      </a>\n    </p>\n    <div class="hidden-xs">\n      <a class="btn btn-lg <%= state == \'ready\' ? \' \' : \'disabled\' %>"\n          href="add-to-basket">\n        <span class="glyphicon glyphicon-shopping-cart"></span>\n        &nbsp; Add to basket&nbsp;\n      </a>\n    </div>\n  </div>\n  <h3 class="">\n    Breakdown:\n  </h3>\n  <p>\n    <div class="row">\n      <div class="col-xs-4">\n        Making:\n      </div>\n      <div class="col-xs-8">\n        <%- mfr_price %>\n      </div>\n    </div>\n    <div class="row">\n      <div class="col-xs-4">\n        Design:\n      </div>\n      <div class="col-xs-8">\n        <%- design_price %>\n      </div>\n    </div>\n    <div class="row">\n      <div class="col-xs-4">\n        TOTAL:\n      </div>\n      <div class="col-xs-8">\n        <%- total_price %>\n      </div>\n    </div>\n    <div class="row">\n      <div class="col-xs-12">\n        <em>Includes VAT but excludes delivery.</em>\n      </div>\n    </div>\n  </p>\n</div>',u=function(e){function n(){return this.render=t(this.render,this),this.handle_product_selected=t(this.handle_product_selected,this),this.handle_maker_selected=t(this.handle_maker_selected,this),this.handle_change=t(this.handle_change,this),this.handle_add_to_basket=t(this.handle_add_to_basket,this),n.__super__.constructor.apply(this,arguments)}return i(n,e),n.prototype.events={"click #add-to-basket-link":"handle_add_to_basket"},n.prototype.states={select_product:"select_product",select_maker:"select_maker",ready:"ready"},n.prototype.template=_.template(q),n.prototype.handle_add_to_basket=function(){var t,e,i,n,s,o,r,a,l,h,d;return this.model.get("state"!==this.states.ready)?!1:(i=this.model.get("country_code"),h=this.model.get("region_name"),e=this.model.get("address"),s=this.model.get("lat"),o=this.model.get("lng"),a=this.model.get("quantity"),l=this.model.get("quote"),n={country_code:i,region_name:h,location:e,lat:s,lng:o,quote:l.id,quantity:a},t=$("#js-loading-indicator"),t.fadeIn(),d=this.$el.data("action"),r={type:"POST",data:n,dataType:"json",success:function(t){return window.location.href=t.location},error:function(){return alert("Whoops! There was an error. Please try again.")},complete:function(){return t.fadeOut()}},$.ajax(d,r),!1)},n.prototype.handle_change=function(){var t;return this.model.has("product")||(t={state:this.states.select_product},this.model.set(t,{silent:!0})),this.render()},n.prototype.handle_maker_selected=function(t){var e,i,n;return i=this.model.get("product"),n=t.get_quote(i),e={maker:t,quote:n,state:this.states.ready},this.model.set(e),this.render()},n.prototype.handle_product_selected=function(t){return this.model.set({maker:null,product:t,quote:null,state:this.states.select_maker})},n.prototype.render=function(){var t,e,i,n,s,o,r,a,l,h;return e=opendesk.util.currency_convert,r=opendesk.util.display_price,a=null,h=null,t=_.clone(this.model.attributes),l=this.model.get("quantity"),l==null&&(l=1,t.quantity=1),n=t.design_price_currency,s=t.design_price_value*l,o={design_price:r(s,n),mfr_price:"",total_price:""},t.quote!=null&&(i=t.quote.currency,s=e(s,n,i),a=t.quote.value*l,h=s+a,o={design_price:r(s,i),mfr_price:r(a,i),total_price:r(h,i)}),this.$el.html(this.template(_.extend(t,o)))},n.prototype.initialize=function(){return this.model.set({state:this.states.select_product}),this.listenTo(this.model,"change",this.handle_change),this.listenTo(b,"maker:selected",this.handle_maker_selected),this.listenTo(b,"product:selected",this.handle_product_selected)},n}(Backbone.View),f=function(e){function n(){return this.handle_reset=t(this.handle_reset,this),this.handle_select=t(this.handle_select,this),n.__super__.constructor.apply(this,arguments)}return i(n,e),n.prototype.handle_select=function(){var t;return t=this.makers.findWhere({state:"selected"}),t==null&&(t=this.makers.findWhere({state:"active"})),b.trigger("maker:selected",t)},n.prototype.handle_reset=function(){var t;if(this.products.length)return t=this.products.findWhere({state:"selected"}),t==null&&(t=this.products.findWhere({is_default:!0})),t==null&&(t=this.products.at(0)),this.stopListening(b,"product:selected",this.handle_select),this.listenTo(b,"product:selected",this.handle_select),b.trigger("product:selected",t)},n.prototype.initialize=function(){return this.makers=this.options.makers,this.maker_listing=new h({collection:this.makers,el:this.$("#maker-listing")}),this.products=this.options.products,this.product_listing=new g({collection:this.products,el:this.$("#product-listing")}),this.listenTo(this.products,"reset",this.handle_reset)},n}(Backbone.View),o=function(e){function n(){return this.initialize=t(this.initialize,this),this.select=t(this.select,this),this.render=t(this.render,this),this.set_location=t(this.set_location,this),n.__super__.constructor.apply(this,arguments)}return i(n,e),n.prototype.events={click:"select"},n.prototype.set_location=function(t,e){var i,n;return i=opendesk.util.get_location_path().split("/get-it"),n=""+i[0]+"/get-it/"+t,t==="made"&&e&&(n+="/"+e),opendesk.controller.navigate(n,{trigger:!1}),typeof _gaq!="undefined"&&_gaq!==null?_gaq.push(["_trackPageview",n]):void 0},n.prototype.render=function(){var t,e,i,n;return n=this.model.get("mode"),e=this.model.get("form"),i=n==="download"?"download":e,t=this.$(".square-tab"),t.each(function(){var t,e,n,s;return e=$(this),t=e.closest("a"),n=i===t.data("form"),s=n?"addClass":"removeClass",e[s]("active")}),this.set_location(n,e)},n.prototype.select=function(t){var e,i,n,s,o;return i=$(t.target),e=i.closest("a"),s=e.data("form"),o=s==="download"?"download":"made",n={form:s,mode:o},this.model.set(n),this.set_location(o,s),!1},n.prototype.initialize=function(){var t,e;return this.listenTo(this.model,"change:form",this.render),this.listenTo(this.model,"change:mode",this.render),this.render(),e=this.model.get("mode"),t=this.model.get("form"),this.set_location(e,t)},n}(Backbone.View),v=function(e){function n(){return this.initialize=t(this.initialize,this),this.render=t(this.render,this),this.handle_stop=t(this.handle_stop,this),this.handle_slide=t(this.handle_slide,this),this.get_attrs=t(this.get_attrs,this),n.__super__.constructor.apply(this,arguments)}return i(n,e),n.prototype.get_attrs=function(){var t,e,i,n;return n=this.model.get("quantity"),n||(n=1),i=this.model.get("min_quantity"),e=this.model.get("max_quantity"),t={animate:!0,min:i,max:e,step:1,value:n}},n.prototype.handle_slide=function(t,e){return this.$value_label.text(e.value)},n.prototype.handle_stop=function(t,e){return this.model.set({quantity:e.value})},n.prototype.render=function(){var t;return t=this.get_attrs(),this.$min_label.text(t.min),this.$max_label.text(t.max),this.$value_label.text(t.value),this.$slider.slider("option","min",t.min),this.$slider.slider("option","max",t.max),this.$slider.slider("value",t.value)},n.prototype.initialize=function(){var t;return this.$slider=this.$(".quantity-slider"),this.$min_label=this.$(".quantity-min-label"),this.$max_label=this.$(".quantity-max-label"),this.$value_label=this.$(".quantity-value-label"),t=this.get_attrs(),t.slide=this.handle_slide,t.stop=this.handle_stop,this.$slider.slider(t),this.listenTo(this.model,"change",this.render),this.render()},n}(Backbone.View),c=function(e){function n(){return this.initialize=t(this.initialize,this),this.render=t(this.render,this),n.__super__.constructor.apply(this,arguments)}return i(n,e),n.prototype.render=function(){var t,e,i,n;if(e=this.model.get("mode"),e==="made"){for(n=Backbone.history.getFragment(),n.endsWith("/")&&(n=n.slice(0,-1)),i=n.split("/");;)if(t=i.pop(),t==="get-it"){i.push(t);break}i.push("made"),i.push(this.model.get("form")),n=i.join("/"),this.$el.attr({action:"/"+n})}return this.$form_input.val(this.model.get("form")),this.$address_input.val(this.model.get("address")),this.$lat_input.val(this.model.get("lat")),this.$lng_input.val(this.model.get("lng"))},n.prototype.initialize=function(){return this.$form_input=this.$("input[name=form]"),this.$address_input=this.$("input[name=address]"),this.$lat_input=this.$("input[name=lat]"),this.$lng_input=this.$("input[name=lng]"),this.listenTo(this.model,"change:form",this.render),this.listenTo(this.model,"change:address",this.render),this.listenTo(this.model,"change:lat",this.render),this.listenTo(this.model,"change:lng",this.render),this.render()},n}(Backbone.View),r=function(e){function s(){return this.render=t(this.render,this),this.handle_location_change=t(this.handle_location_change,this),this.handle_results=t(this.handle_results,this),this.set_point_str=t(this.set_point_str,this),this.reset_order=t(this.reset_order,this),this.fetch_results=t(this.fetch_results,this),this._fetch_results=t(this._fetch_results,this),s.__super__.constructor.apply(this,arguments)}return i(s,e),s.prototype.modes={download:"download",made:"made"},s.prototype.defaults={query_endpoint:window.location.pathname,location_form_selector:"#delivery-location-form",stored_location_attrs:["address","country_code","region_name","lat","lng","ne_str","sw_str"]},s.prototype._fetch_results=function(t,e,i,n,s){var o,r=this;return this.reset_order(),this.$loading_indicator.fadeIn(),o={type:"POST",data:{country_code:t,form:e,lat:i,lng:n,quantity:s},dataType:"json",success:this.handle_results,complete:function(){return r.$loading_indicator.fadeOut()}},$.ajax(this.options.query_endpoint,o),!1},s.prototype.fetch_results=function(){var t,e,i,n,s,o;return e=this.model.get("country_code"),i=this.model.get("form"),n=this.model.get("lat"),s=this.model.get("lng"),o=this.model.get("quantity"),e!=null&&i!=null&&n!=null&&s!=null&&(t=""+e+i+n+s+o,t!==this._last_fetch_results_check_str)?(this._fetch_results(e,i,n,s,o),this._last_fetch_results_check_str=t):void 0},s.prototype.reset_order=function(){var t,e,i,n;return e=opendesk.bootstrap.form_name_mapping,i=this.model.get("form"),n=this.model.get("quantity"),t={design_price_currency:null,design_price_value:null,form_name:e[i],maker:null,product:null,quantity:n,quote:null},this.model.set(t)},s.prototype.set_point_str=function(){var t,e,i;return t=this.model.get("lat"),e=this.model.get("lng"),i=t&&e?""+t+","+e:null,this.model.set({point_str:i})},s.prototype.handle_results=function(t){var e,i,n,s,o,r,a,l,h,d,c,u,p,_,m,g,f;return e={quantity:t.quantity,min_quantity:t.min_quantity,max_quantity:t.max_quantity,design_price_value:t.design_price_value,design_price_currency:t.design_price_currency,indicative_price_range:t.indicative_price_range},this.model.set(e),this.makers.reset(t.makers!=null?t.makers:[]),this.products.reset(t.products!=null?t.products:[]),this.makers.length?(this.$render_container.fadeIn(),this.$select_quote_ui.show(),this.$no_results_ui.hide()):(this.$render_container.fadeOut(),this.$select_quote_ui.hide(),this.$no_results_ui.show(),f=this.model.get("indicative_price_range"),f==null?this.$indicative_price.hide():(n=f.local_currency,i=opendesk.util.currency_convert,l=opendesk.util.display_price,a=this.model.get("design_price_value"),s=this.model.get("design_currency"),o=i(a,s,n),_=i(f.min,f.currency,n),u=i(f.max,f.currency,n),m=l(_+o,n),p=l(u+o,n),h=this.model.get("form"),r=this.model.get("design_name"),d=h==="assembled"?"an assembled":"a "+h,c="From c. "+m,g="The cost of an OpenDesk varies from maker to\nmaker and by factors like material and finish. However,\nas a rough indication, the price of a "+d+"\n"+r+" is likely to be "+m+" - "+p+".",this.$indicative_price_title.text(c),this.$indicative_price_description.text(g),this.$indicative_price.show()))},s.prototype.handle_location_change=function(t){return this.model.set(t)},s.prototype.render=function(){var t,e,i,s,o,r,a,l;if(o=this.model.get("mode"),t=this.model.get("form"),i=this.model.get("has_delivery_location"),s=!!this.model.get("supported_location"),l=this.model.get("supported_modes"),a=_.clone(this.model.get("supported_forms")),n.call(l,"download")>=0&&0>n.call(a,"download")&&a.push("download"),r=0>n.call(l,o),e=t&&0>n.call(a,t),r||e)return this.$not_found_panel.show(),void 0;if(this.$not_found_panel.hide(),o===this.modes.download)return this.$mode_title.text("Download"),this.$location_bar.slideUp(),this.$form_dialog_message.slideUp(),this.$form_select_ui.slideUp(),this.$made_panel.hide(),this.$render_container.fadeOut(),this.$form_tabs.show(),this.$download_panel.show(),void 0;if(o!==this.modes.made)throw Error(""+o+" is not supported.");return this.$mode_title.text("Get it Made"),this.$location_bar.slideDown(),i?(this.$location_dialog_message.slideUp(),t?(this.$form_dialog_message.slideUp(),this.$form_select_ui.slideUp(),this.$download_panel.hide(),this.$location_bar.show(),this.$form_tabs.show(),this.$made_panel.show(),this.$render_container.fadeIn(),this.fetch_results(),void 0):(this.$made_panel.hide(),this.$render_container.fadeOut(),this.$download_panel.hide(),this.$form_tabs.hide(),this.$form_dialog_message.show(),this.$form_select_ui.show(),void 0)):(this.$made_panel.hide(),this.$render_container.fadeOut(),this.$download_panel.hide(),this.$form_tabs.hide(),this.$location_dialog_message.show(),this.$location_dialog_message,void 0)},s.prototype.initialize=function(){var t,e,i,n,s,r,a,h,d=this;for(this.options=_.defaults(this.options,this.defaults),this.$mode_title=$("#js-mode-title"),this.$location_bar=$("#js-location-bar"),this.$location_dialog_message=$("#js-location-dialog-message"),this.$form_dialog_message=$("#js-form-dialog-message"),this.$form_select_ui=$("#js-form-select-ui"),this.$form_tabs=$("#js-form-tabs"),this.$download_panel=$("#js-download-panel"),this.$made_panel=$("#js-made-panel"),this.$select_quote_ui=$("#js-select-quote-ui"),this.$no_results_ui=$("#js-no-results-ui"),this.$no_results_form=$("#quote-request-form"),this.$not_found_panel=$("#js-404-panel"),this.$quantity_slider=$("#js-quantity-slider"),this.$render_container=$("#js-render-container"),this.$order_summary_widget=$("#js-order-summary-widget"),this.$loading_indicator=$("#js-loading-indicator"),this.$indicative_price=$("#js-indicative-price"),this.$indicative_price_title=$("#js-indicative-price > h3"),this.$indicative_price_description=$("#js-indicative-price p"),this.makers=new l,this.products=new m,this.selection_view=new f({el:this.el,makers:this.makers,products:this.products}),this.$form=this.$(this.options.location_form_selector),s=new Backbone.Model,h=this.options.stored_location_attrs,r=0,a=h.length;a>r;r++)t=h[r],s.set(t,this.model.get(t));return this.location_widget=new opendesk.view.location.DeliveryLocationWidget({el:this.$form,model:s,map_styles:opendesk.style.map_styles}),this.download_view=new opendesk.view.design.DownloadPage({el:this.$download_panel,model:new Backbone.Model}),this.select_widget=new o({el:this.$form_select_ui,model:this.model}),this.tabs_widget=new o({el:this.$form_tabs,model:this.model}),this.no_results_form_view=new c({el:this.$no_results_form,model:this.model}),this.model.get("form")||this.model.set({form:this.model.get("default_form")}),e={min_quantity:1,max_quantity:10},this.model.set(e),this.quantity_widget=new v({el:this.$quantity_slider,model:this.model}),i="delivery-location-widget:done",this.listenTo(b,i,this.handle_location_change),this.render_widget=new w({el:this.$render_container,model:this.model}),this.summary_view=new u({el:this.$order_summary_widget,model:this.model}),this.listenTo(this.model,"change:mode",this.render),this.listenTo(this.model,"change:form",this.render),this.listenTo(this.model,"change:has_delivery_location",this.render),this.listenTo(this.model,"change:lat",this.set_point_str),this.listenTo(this.model,"change:lng",this.set_point_str),this.listenTo(this.model,"change:point_str",this.fetch_results),this.listenTo(this.model,"change:quantity",this.fetch_results),this.set_point_str(),this.render(),n=function(){return d.$(".form-panel-flash-messages").slideUp()},window.setTimeout(n,1e4)},s}(Backbone.View),e.GetItPage=r});var e={}.hasOwnProperty,i=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t};define("opendesk.view.index",function(t){var e;return e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.initialize=function(){var t,e,i,n,s,o,r,a,l,h;return n=this.$("#map"),i=this.$("#map-form"),t=$("#js-explore-map-link"),e=this.$(".js-explore-map-link"),e.click(function(){var e;return e=new fabhub.view.map.MapView({el:i,map:n,model:new Backbone.Model,map_styles:opendesk.style.map_styles,map_height:.7,map_bg:"#F9F9FA",min_zoom:2}),t.css({visibility:"hidden",width:"1px"}),!1}),l=null,a=!1,s=$(".press-quote-tabs li"),s.one("click",function(){return a=!0}),h=function(){var t,e;return t=s.filter(".active"),e=t.next("li"),e.length||(e=s.filter("li:first")),e.find("a").tab("show")},o=function(){return a?(window.clearInterval(l),void 0):h()},r=function(){return a?void 0:(h(),l=window.setInterval(o,7e3))},window.setTimeout(r,10500)},e}(Backbone.View),t.IndexPage=e});var t=function(t,e){return function(){return t.apply(e,arguments)}},e={}.hasOwnProperty,i=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t};define("opendesk.view.location",function(e){var n,s,o,r,a,l,h,d,c,u;return c=opendesk.util.broadcaster,u=function(t){var e,i;if(t)return i=t.split(","),e=_.map(i,parseFloat),new google.maps.LatLng(e[0],e[1])},n=function(e){function n(){return this.initialize=t(this.initialize,this),this.resize_map_container=t(this.resize_map_container,this),this.handle_resize=t(this.handle_resize,this),this.set_composite_location_str=t(this.set_composite_location_str,this),this.toggle_done=t(this.toggle_done,this),this.handle_done=t(this.handle_done,this),this.handle_marker_move=t(this.handle_marker_move,this),this.handle_location_select=t(this.handle_location_select,this),this.set_address_value=t(this.set_address_value,this),this.contract=t(this.contract,this),this.expand=t(this.expand,this),n.__super__.constructor.apply(this,arguments)}return i(n,e),n.prototype.flags={should_fit_bounds:!0},n.prototype.states={expanded:"EXPANDED",contracted:"CONTRACTED"},n.prototype.defaults={map_height:.5,slide_speed:500,start_zoom:13},n.prototype.expand=function(){var t=this;return this.$input.removeClass("full-width"),this.$submit.show(),this.$map_container.css({visibility:"visible"}),this.$map_container.slideDown(this.options.slide_speed,function(){return t.state=t.states.expanded,t.handle_resize(),t.toggle_done()})},n.prototype.contract=function(){var t=this;return this.$input.addClass("full-width"),this.$submit.hide(),this.$map_container.slideUp(this.options.slide_speed,function(){return t.state=t.states.contracted})},n.prototype.set_address_value=function(){var t;return t=this.model.get("address"),t==null&&(t=""),this.$input.val(t)},n.prototype.handle_location_select=function(){var t,e,i,n;return e=u(this.model.get("ne_str")),n=u(this.model.get("sw_str")),e&&n&&this.map.fitBounds(new google.maps.LatLngBounds(n,e)),i=u(this.model.get("point_str")),i?(t={lat:i.lat(),lng:i.lng()},this.model.set(t),this.map.setCenter(i),this.marker.setPosition(i)):void 0},n.prototype.handle_marker_move=function(){var t,e,i,n,s=this;return n=this.marker.getPosition(),e=n.lat(),i=n.lng(),t={lat:e,lng:i,point_str:""+e+","+i},this.model.set(t,{silent:!0}),google.maps.event.addDomListenerOnce(this.map,"center_changed",function(){var e;return e=s.map.getBounds(),t={ne_str:e.getNorthEast().toUrlValue(),sw_str:e.getSouthWest().toUrlValue()},s.model.set(t,{silent:!0})}),this.map.setCenter(n),this.geocoder.geocode({location:n},function(e,i){var n;return i===google.maps.GeocoderStatus.OK&&e.length?(n=s.parse_geocoder_result(e[0]),t={address:n.address,country_code:n.country_code,region_name:n.region_name},s.model.set(t)):void 0})},n.prototype.handle_done=function(){var t,e,i=this;return t=this.$form.attr("action"),e={type:"POST",data:this.model.attributes,dataType:"json",success:function(t){var e;return i.model.set(t),e=_.clone(i.model.attributes),c.trigger("delivery-location-widget:done",e)}},$.ajax(t,e),this.set_address_value(),this.contract(),!1},n.prototype.toggle_done=function(){var t;return t=this.model.get("address"),t?this.$submit.removeAttr("disabled"):this.$submit.attr("disabled","disabled")},n.prototype.set_composite_location_str=function(){var t,e;return t=this.model.get("lat"),e=this.model.get("lng"),this.model.set({composite_location_str:""+t+","+e})},n.prototype.handle_resize=function(){var t;if(this.state===this.states.expanded)return t=this.map.getCenter(),this.resize_map_container(),google.maps.event.trigger(this.map,"resize"),t!=null&&this.map.setCenter(t),t!=null?this.marker.setPosition(t):void 0},n.prototype.resize_map_container=function(){var t,e,i;return e=$(window),t=this.$map_element.closest("div"),i=parseInt(e.height()*this.options.map_height),t.height(i)},n.prototype.initialize=function(){var t,e,i,n,s,o,r,a=this;return this.options=_.defaults(this.options,this.defaults),this.$form=this.$el,this.$submit=this.$("input[type=submit]"),this.$input=this.$("input[name=location]"),this.$map_container=$("#delivery-location-map-container"),this.$map_element=$("#delivery-location-map"),this.$submit.hide(),this.$input.attr({autocomplete:"off"}),this.geocoder=new google.maps.Geocoder,this.$input.typeahead({property:"address",source:function(t,e){return e?(a.geocoder.geocode({address:e},function(e,i){return i===google.maps.GeocoderStatus.OK?a.handle_geocode_search(t,e):void 0}),void 0):[]},onselect:function(t){return a.model.set(t)},matcher:function(){return!0},autoselect:!1}),this.resize_map_container(),s=this.$map_element.get(0),e=this.model.get("lat"),i=this.model.get("lng"),r=new google.maps.LatLng(e,i),o={center:r,draggable:!0,mapTypeControl:!1,zoomControl:!0,panControl:!0,mapTypeId:google.maps.MapTypeId.ROADMAP,zoom:this.options.start_zoom},this.options.map_styles!=null&&(o.styles=this.options.map_styles),google.maps.visualRefresh=!0,this.map=new google.maps.Map(s,o),n={draggable:!0,map:this.map,position:r,title:"Delivery Location"},this.marker=new google.maps.Marker(n),t=google.maps.event.addListener,t(this.marker,"dragend",this.handle_marker_move),this.$input.bind("focus",this.expand),this.set_composite_location_str(),this.listenTo(this.model,"change:address",this.set_address_value),this.listenTo(this.model,"change:address",this.toggle_done),this.listenTo(this.model,"change:point_str",this.handle_location_select),this.$form.on("submit",this.handle_done),$(window).on("throttledresize",this.handle_resize),this.handle_resize(),this.handle_location_select(),this.contract(),this.toggle_done(),this.set_address_value()},n}(fabhub.view.location.BaseLocationWidget),h=function(e){function n(){return this.resize_map_container=t(this.resize_map_container,this),this.handle_resize=t(this.handle_resize,this),this.handle_bounds_change=t(this.handle_bounds_change,this),this.handle_location_change=t(this.handle_location_change,this),this.handle_model_change=t(this.handle_model_change,this),this.handle_results=t(this.handle_results,this),this._do_query=t(this._do_query,this),this._latlng=t(this._latlng,this),n.__super__.constructor.apply(this,arguments)}return i(n,e),n.prototype.defaults={debounce_delay:850,map_height:.4,query_endpoint:"/get-regions",start_lat:0,start_lng:0,start_zoom:10,location_change_selectors:"input[name=location]"},n.prototype._latlng=function(t){var e,i;if(t)return i=t.split(","),e=_.map(i,parseFloat),new google.maps.LatLng(e[0],e[1])},n.prototype._do_query=function(t){var e;return e={type:"POST",data:t,dataType:"json",success:this.handle_results},$.ajax(this.options.query_endpoint,e)},n.prototype.handle_results=function(t){var e,i,n,s,o,r,a;if(this._fit_to_bounds){for(n=t.appstruct.bounds,i=new google.maps.LatLngBounds,a=["ne","sw"],o=0,r=a.length;r>o;o++)s=a[o],i.extend(u(n[s]));this._ignore_bounds_change=!0,this.map.fitBounds(i),this._fit_to_bounds=!1}return e=$("#regions-container"),e.text('["'+t.regions.join('", "')+'"]')},n.prototype.handle_model_change=function(){return this._do_query(this.model.get("data"))},n.prototype.handle_location_change=function(){return this._fit_to_bounds=!0,this.model.set({data:this.$form.serialize()}),!1},n.prototype.handle_bounds_change=function(){var t,e,i,n,s,o,r;if(this._ignore_bounds_change)return this._ignore_bounds_change=!1,void 0;for(i=this.map.getBounds(),t={ne:i.getNorthEast().toUrlValue(),sw:i.getSouthWest().toUrlValue()},this.$ne_input.val(t.ne),this.$sw_input.val(t.sw),n=[],r=this.$form.serializeArray(),s=0,o=r.length;o>s;s++)e=r[s],e.name in t&&(e.value=t[e.name]),n.push(e);return this.model.set({data:$.param(n)}),!1},n.prototype.handle_resize=function(){var t;return t=this.map.getCenter(),this.resize_map_container(),google.maps.event.trigger(this.map,"resize"),t!=null?this.map.setCenter(t):void 0},n.prototype.resize_map_container=function(){var t,e;return e=$(window),t=this.$map_container.closest("div"),t.height(parseInt(e.height()*this.options.map_height))},n.prototype.initialize=function(){var t,e,i,n,s,o,r,a=this;return this.options=_.defaults(this.options,this.defaults),this.$form=$(this.el),this.$map_container=$(this.options.map),this.$ne_input=this.$("input[name=ne]"),this.$sw_input=this.$("input[name=sw]"),$("#map-container").resizable(),this.$ne_input.val(""),this.$sw_input.val(""),t=this.$(this.options.location_change_selectors),t.change(this.handle_location_change),this.$form.submit(this.handle_location_change),this.resize_map_container(),o=this.$map_container.get(0),n=this.options.start_lat,s=this.options.start_lng,r={center:new google.maps.LatLng(n,s),draggable:!0,mapTypeControl:!1,mapTypeId:google.maps.MapTypeId.ROADMAP,maxZoom:this.options.max_zoom,minZoom:this.options.min_zoom,zoom:this.options.start_zoom},this.options.map_styles!=null&&(r.styles=this.options.map_styles),google.maps.visualRefresh=!0,this.map=new google.maps.Map(o,r),e=google.maps.event.addListener,i=google.maps.event.addListenerOnce,i(this.map,"bounds_changed",function(){var t,i;return t=a.options.debounce_delay,i=_.debounce(a.handle_bounds_change,t),e(a.map,"bounds_changed",i),a._stored_bounds=a.map.getBounds(),!1}),$(window).on("throttledresize",this.handle_resize),this.model.on("change",this.handle_model_change)},n}(Backbone.View),s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.initialize=function(){var t,e,i,n,s,o;return e=this.$("input[name=location]"),e.attr({autocomplete:"off"}),n=this.$("input[type=submit]"),n.hide(),t=e.closest("form"),o=new fabhub.view.location.LocationBoundsSearchWidget({el:t,model:new Backbone.Model}),i=this.$("#map"),s=new h({el:t,map:i,model:new Backbone.Model})},e}(Backbone.View),a=function(e){function n(){return this.resize_map_container=t(this.resize_map_container,this),this.handle_resize=t(this.handle_resize,this),this.handle_location_change=t(this.handle_location_change,this),this.handle_model_change=t(this.handle_model_change,this),this.handle_results=t(this.handle_results,this),this._do_query=t(this._do_query,this),this._latlng=t(this._latlng,this),n.__super__.constructor.apply(this,arguments)
}return i(n,e),n.prototype.defaults={location_change_selectors:"input[name=location]",map_height:.8,min_result_volume:6,min_zoom:3,max_zoom:19,query_endpoint:"/quote-requests-map/a8b1d02f8d8d3358",start_lat:0,start_lng:0,start_zoom:10},n.prototype._latlng=function(t){var e,i;if(t)return i=t.split(","),e=_.map(i,parseFloat),new google.maps.LatLng(e[0],e[1])},n.prototype._do_query=function(t){var e,i=this;return e={type:"POST",data:t,dataType:"json",success:this.handle_results,complete:function(){return i.$loading_indicator.fadeOut()}},$.ajax(this.options.query_endpoint,e)},n.prototype.handle_results=function(t){var e,i,n,s,o,r,a,l,h,d,c;o=[];for(s in t)l=t[s],$.isArray(l)&&o.push.apply(o,l);if(a=this.model.get("triggered_by"),r=a==="filter"||a==="location",this.collection.set(o,{remove:r}),i=t.appstruct.bounds,!i.ne){for(e=new google.maps.LatLngBounds,c=this.collection.models,h=0,d=c.length;d>h;h++)n=c[h],e.extend(n.getLatlng());this.map.fitBounds(e)}},n.prototype.handle_model_change=function(){return this._do_query(this.model.get("data"))},n.prototype.handle_location_change=function(){var t,e,i;return t=this._latlng(this.$ne_input.val()),e=this._latlng(this.$sw_input.val()),t&&e?(i=new google.maps.LatLngBounds(e,t),this.map.fitBounds(i)):void 0},n.prototype.handle_resize=function(){var t;return t=this.map.getCenter(),this.resize_map_container(),google.maps.event.trigger(this.map,"resize"),t!=null?this.map.setCenter(t):void 0},n.prototype.resize_map_container=function(){var t,e;return e=$(window),t=this.$map_container.closest("div"),t.height(parseInt(e.height()*this.options.map_height))},n.prototype.initialize=function(){var t,e,i,n,s;return this.options=_.defaults(this.options,this.defaults),this.$form=$(this.el),this.$map_container=$(this.options.map),this.$ne_input=this.$("input[name=ne]"),this.$sw_input=this.$("input[name=sw]"),this.$loading_indicator=$("#map-loading-indicator"),this.$ne_input.val(""),this.$sw_input.val(""),t=this.$(this.options.location_change_selectors),t.change(this.handle_location_change),this.$form.submit(this.handle_filter_change),this.resize_map_container(),n=this.$map_container.get(0),e=this.options.start_lat,i=this.options.start_lng,s={center:new google.maps.LatLng(e,i),draggable:!0,mapTypeControl:!1,mapTypeId:google.maps.MapTypeId.ROADMAP,maxZoom:this.options.max_zoom,minZoom:this.options.min_zoom,zoom:this.options.start_zoom},this.options.map_styles!=null&&(s.styles=this.options.map_styles),google.maps.visualRefresh=!0,this.map=new google.maps.Map(n,s),this.collection=new fabhub.view.map.MapCollection,this.listing=new fabhub.view.map.MarkerListing({collection:this.collection,map:this.map,max_zoom:this.options.max_zoom-2}),this.listing.render(),$(window).on("throttledresize",this.handle_resize),this.model.on("change",this.handle_model_change),this.model.trigger("change")},n}(Backbone.View),l=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.initialize=function(){var t,e,i,n,s,o;return e=this.$("input[name=location]"),e.attr({autocomplete:"off"}),n=this.$("input[type=submit]"),n.hide(),t=e.closest("form"),o=new fabhub.view.location.LocationBoundsSearchWidget({el:t,model:new Backbone.Model}),i=this.$("#map"),s=new a({el:t,map:i,model:new Backbone.Model})},e}(s),d=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.initialize=function(){var t,e,i,n,s,o,r;return o=this.options.location_data?this.options.location_data:opendesk.bootstrap.delivery_location_data,e=this.$("#js-location-display"),i=this.$("#js-location-edit"),n=this.$("form#search-form"),s=i.find("input[name=address]"),t=n.find("input[type=submit]"),e.click(function(){var t,n;return e.addClass("hidden-state"),i.removeClass("hidden-state"),s.focus(),n=s.get(0),n.setSelectionRange!=null?(t=s.val().length*2,n.setSelectionRange(t,t)):s.val(s.val()),s.val(s.val()),s.data("typeahead").lookup(),!1}),r=new fabhub.view.location.LocationSearchWidget({el:n,model:new Backbone.Model}),s.change(function(){return t.click()})},e}(Backbone.View),o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.initialize=function(){var t,e,i;return t=this.$("#js-location-display"),e=this.$("#js-location-edit"),i=e.find("input[name=location]"),t.click(function(){return t.addClass("hidden-state"),e.removeClass("hidden-state"),i.focus(),!1})},e}(Backbone.View),r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.initialize=function(){return e.__super__.initialize.call(this),new o({el:this.el})},e}(fabhub.view.map.MapPage),e.DeliveryLocationWidget=n,e.GetRegionsPage=s,e.QuoteRequestsMapPage=l,e.SupportedLocationWidget=d,e.MapLocationWidget=o,e.MapPage=r});var e={}.hasOwnProperty,i=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t};define("opendesk.view.maker",function(t){var e;return e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.initialize=function(){return new opendesk.view.location.SupportedLocationWidget({el:this.el})},e}(Backbone.View),t.MakersListingPage=e});var t=function(t,e){return function(){return t.apply(e,arguments)}},e={}.hasOwnProperty,i=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},n=[].indexOf||function(t){for(var e=0,i=this.length;i>e;e++)if(e in this&&this[e]===t)return e;return-1};define("opendesk.view.order",function(e){var s,o,r,a,l;return l=opendesk.util.display_price,o=function(e){function n(){return this.render=t(this.render,this),this.handle_incr=t(this.handle_incr,this),this.handle_decr=t(this.handle_decr,this),this.handle_delete=t(this.handle_delete,this),this._change_quantity=t(this._change_quantity,this),n.__super__.constructor.apply(this,arguments)}return i(n,e),n.prototype.events={"click .delete-link":"handle_delete","click .quantity-control .quantity-decr":"handle_decr","click .quantity-control .quantity-incr":"handle_incr"},n.prototype._change_quantity=function(t){var e,i,n,s,o=this;return e=this.$("form"),s=e.attr("action"),i={quantity:t},n={type:"POST",data:i,dataType:"json",success:function(t){return o.model.set(t)}},$.ajax(s,n)},n.prototype.handle_delete=function(t){var e,i,n,s=this;return e=$(t.target),n=e.closest("a").attr("href"),i={type:"POST",dataType:"json",success:function(){return s.$el.slideUp(400,function(){return s.model.collection.remove(s.model),s.remove()})}},$.ajax(n,i),!1},n.prototype.handle_decr=function(){var t;return t=this.model.get("quantity"),this._change_quantity(t-1),!1},n.prototype.handle_incr=function(){var t;return t=this.model.get("quantity"),this._change_quantity(t+1),!1},n.prototype.render=function(){var t,e,i;return this.$quantity_value.text(this.model.get("quantity")),i=this.model.get("total"),t=this.model.get("currency"),e=l(i,t),this.$total_value.text(e)},n.prototype.initialize=function(){var t,e;return this.listenTo(this.model,"change",this.render),this.$quantity_value=this.$(".quantity-value"),this.$total_value=this.$(".order-item-total .total-value"),t=this.$(".order-item-total"),e={currency:t.data("currency"),quantity:parseInt(this.$quantity_value.text()),total:parseFloat(t.data("total"))},console.log(e),this.model.set(e)},n}(Backbone.View),s=function(e){function n(){return this.fetch_delivery=t(this.fetch_delivery,this),this.render=t(this.render,this),n.__super__.constructor.apply(this,arguments)}return i(n,e),n.prototype.render=function(){var t,e,i,n,s,o,r,a,h,d,c,u,p,_,m,g,f,y,v,w;if(c=this.collection.length,1>c)this.$order_total.html('<h4 class="name">\n  <strong>\n    No items in basket\n  </strong>\n</h4>'),this.$place_order_form.slideUp(),this.$what_happens_next.slideUp();else{for(this.$place_order_form.slideDown(),this.$what_happens_next.slideDown(),m={},w=this.collection.pluck("currency"),y=0,v=w.length;v>y;y++)n=w[y],m[n]=0;if(this.collection.each(function(t){var e;return n=t.get("currency"),e=t.get("total"),m[n]+=e}),h=[],this.model.get("has_delivery")){p=0,r=this.model.get("delivery_value"),s=this.model.get("delivery_currency"),i=opendesk.util.currency_convert;for(n in m){if(n==null)break;g=i(m[n],n,s),p+=g}a=l(p,s),h.push('<span class="order-total-gbp-value">\n  '+a+"\n</span>"),o=r!=null&&.1>r?"FREE":l(r,s),h.push('<span class="order-total-gbp-value">\n  '+o+"\n</span>"),p+=parseFloat(r),_=l(p,s),f=this.model.get("vat_percentage"),h.push('<span class="order-total-gbp-value">\n  <h4 class="name">\n    <strong>'+_+'</strong>\n    <br />\n    <span style="text-transform: none; font-size: 85%">\n      Includes VAT at '+parseInt(f)+"%.</span>\n    <span>\n  </h4>\n</span>"),u={stripe_total:p,stripe_currency:s},this.model.set(u,{silent:!0})}else{d=this.model.get("has_vat");for(n in m)a=l(m[n],n),h.push('<span class="order-total-gbp-value">\n  <h4>\n    <strong class="name">\n      '+a+'\n    </strong>\n    <br />\n    <span style="text-transform: none; font-size: 85%">\n      Excludes\n      '+((d!=null?d:"Delivery.")||"VAT &amp; delivery.")+"\n    <span>\n  </h4>\n</span>")}this.$order_total.html(h.join("<br />"))}return t=$("#num-order-items"),t.text(c),e=$(".view-basket-link"),1>c&&e.hasClass("active")?e.removeClass("active"):void 0},n.prototype.fetch_delivery=function(t){var e,i,n=this;return this.model.get("has_delivery")?(i="/order/get-delivery-quote",e={type:"GET",dataType:"json",success:function(t){return t?(n.model.set("delivery_value",t.value),n.model.set("delivery_currency",t.currency)):n.model.set("has_delivery",!1)},complete:function(){return t()}},$.ajax(i,e)):t()},n.prototype.initialize=function(){var t,e,i,n=this;return this.$order_total=this.$(".order-total-value"),this.$order_delivery=this.$(".order-delivery"),this.$order_vat=this.$(".order-vat"),this.$place_order_form=$("#js-place-order-form"),this.$what_happens_next=$("#js-what-happens-next"),this.$order_delivery.length&&(this.model.set("has_delivery",!0),this.model.set("delivery_value",this.$order_delivery.data("total")),this.model.set("delivery_currency",this.$order_delivery.data("currency"))),this.$order_vat.length&&(e=this.$order_vat.data("percentage"),e!=null&&(this.model.set("has_vat",!0),this.model.set("vat_percentage",e))),this.collection=new Backbone.Collection,this.listenTo(this.collection,"add",this.render),this.listenTo(this.collection,"remove",function(){return n.fetch_delivery(n.render)}),this.listenTo(this.collection,"change",function(){return n.fetch_delivery(n.render)}),i=this.collection,t=this.$(".order-item"),t.each(function(){var t;return t=new Backbone.Model,new o({el:this,model:t}),i.add(t)}),this.listenTo(this.model,"change",this.render),this.render()},n}(Backbone.View),r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.initialize=function(){var t,i,s=this;return e.__super__.initialize.call(this),this.$form=this.$("form[id=deform]"),this.$submit_btn=this.$(".form-actions input[type=submit]"),this.$name_input=this.$("input[name=name]"),this.$email_input=this.$("input[name=email]"),this.$deadline_input=this.$("input[name=deadline]"),this.$token_input=this.$("input[name=stripe_token_json_str]"),t="opendesk:assets/gfx/opendesk_icon_logo_dark.png",i=opendesk.bootstrap.stripe.publish_key,this.handler=StripeCheckout.configure({key:i,name:"OpenDesk",image:assetgen.static_url(t),token:function(t){return s.$token_input.val(JSON.stringify(t)),s.$submit_btn.click()}}),this.$form.on("submit",function(){var t,e,i,o,r,a,h,d,c;return i=s.model.get("has_delivery"),a=s.model.get("stripe_total"),r=s.model.get("stripe_currency"),i&&a&&r&&(h=s.$token_input.val(),!h&&(o=s.$name_input.val(),e=s.$email_input.val(),t=s.$deadline_input.val(),o&&e&&t&&e.length>2&&n.call(e,"@")>=0))?(c=l(a,r),d=Math.round(a)*100,s.handler.open({description:"Place Your Order ("+c+")",amount:d,currency:r,email:e}),!1):void 0})},e}(s),a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e}(s),e.PlaceOrderPage=r,e.ViewOrderPage=a});var t=function(t,e){return function(){return t.apply(e,arguments)}},e={}.hasOwnProperty,i=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t};define("opendesk.view.product",function(e){var n,s,o,r,a,l,h,d,c,u,p,m,g,f,y,v,w,b;return g=_.extend({},Backbone.Events),y=function(t,e){var i,n;return n={name:e},i=_.findWhere(t,n),i.value},f=function(t,e,i){var n,s;return s={name:e},n=_.findWhere(t,s),n.value||(n.value=i),t},o=function(e){function n(){return this.get_quote=t(this.get_quote,this),n.__super__.constructor.apply(this,arguments)}return i(n,e),n.prototype.idAttribute="path",n.prototype.get_quote=function(t){var e,i,n,s;if(this.has("quotes"))for(s=this.get("quotes"),i=0,n=s.length;n>i;i++)if(e=s[i],e.product===t.get("slug"))return e},n}(Backbone.Model),d=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.idAttribute="path",e}(Backbone.Model),r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.model=o,e}(Backbone.Collection),c=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.model=d,e}(Backbone.Collection),n=function(e){function n(){return this.handle_select=t(this.handle_select,this),this.render=t(this.render,this),n.__super__.constructor.apply(this,arguments)}var s;return i(n,e),s=null,n.prototype.states={active:"active",hidden:"hidden",inactive:"inactive",selected:"selected"},n.prototype.render=function(){return this.$el.html(this.template(this.model.attributes))},n.prototype.handle_select=function(){if(this.model.get("state"!==this.states.active))return!1;try{g.trigger(""+this.content_type+":selected",this.model)}catch(t){typeof console!="undefined"&&console!==null&&console.error!=null&&console.error(t)}return!1},n.prototype.initialize=function(){return n.__super__.initialize.call(this),this.$el.click(this.handle_select)},n}(opendesk.view.base.BaseWidget),v='<div class="span4 result <%= content_type %> <%= state %>">\n  <% if (price) { %>\n    <div class="result-price-label">\n      <%= price %>\n    </div>\n  <% } %>\n  <%= tmpl %>\n</div>',l=function(e){function n(){return this.handle_product_selected=t(this.handle_product_selected,this),this.handle_maker_selected=t(this.handle_maker_selected,this),n.__super__.constructor.apply(this,arguments)}return i(n,e),n.prototype.content_type="maker",n.prototype.template=_.template(v),n.prototype.handle_maker_selected=function(t){var e;return e=this.model.get("state"),this.model===t&&e===this.states.active&&this.model.set("state",this.states.selected),this.model!==t&&e===this.states.selected?this.model.set("state",this.states.active):void 0},n.prototype.handle_product_selected=function(t){var e,i,n;return n=this.model.get_quote(t),n==null?e={state:this.states.hidden}:(i=opendesk.util.display_price,e={price:i(n.value,n.currency),state:this.states.active}),this.model.set(e)},n.prototype.initialize=function(){var t;return t={content_type:this.content_type,price:null,state:this.states.inactive},this.model.set(t),this.listenTo(g,"maker:selected",this.handle_maker_selected),this.listenTo(g,"product:selected",this.handle_product_selected),n.__super__.initialize.call(this)},n}(n),b='<div class="span4 result <%= content_type %> <%= state %>">\n  <%= tmpl %>\n</div>',m=function(e){function n(){return this.handle_product_selected=t(this.handle_product_selected,this),this.handle_maker_selected=t(this.handle_maker_selected,this),n.__super__.constructor.apply(this,arguments)}return i(n,e),n.prototype.content_type="product",n.prototype.template=_.template(b),n.prototype.handle_maker_selected=function(){},n.prototype.handle_product_selected=function(t){var e;return e=t===this.model?this.states.selected:this.states.active,this.model.set("state",e)},n.prototype.initialize=function(){var t;return t={content_type:this.content_type,state:this.states.active},this.model.set(t),this.listenTo(g,"maker:selected",this.handle_maker_selected),this.listenTo(g,"product:selected",this.handle_product_selected),n.__super__.initialize.call(this)},n}(n),a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.widget_cls=l,e}(opendesk.view.base.BaseListing),u=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.widget_cls=m,e}(opendesk.view.base.BaseListing),w='<div class="order-summary <%= state %>">\n  <div class="top clearfix">\n    <ul class="cost-layers">\n      <li class="clearfix">\n        <div class="layer">Quantity:</div>\n        <div class="range"><%- quantity %></div>\n      </li>\n      <li class="clearfix">\n        <div class="layer">Form:</div>\n        <div class="range"><%- form_name %></div>\n      </li>\n      <li class="clearfix">\n        <div class="layer">Product:</div>\n        <div class="range">\n          <%- product !== null ? product.get(\'name\') : \'\' %>\n        </div>\n      </li>\n      <li class="clearfix">\n        <div class="layer">Maker:</div>\n        <div class="range">\n          <%- maker !== null ? maker.get(\'name\') : \'\' %>\n        </div>\n      </li>\n      <li class="clearfix">\n        <div class="layer">Design fee:</div>\n        <div class="range"><%- design_price %></div>\n      </li>\n      <li class="clearfix">\n        <div class="layer">Manufacture:</div>\n        <div class="range"><%- mfr_price %></div>\n      </li>\n      <!--li class="clearfix">\n        <div class="layer">VAT & Delivery:</div>\n        <div class="range">Excl.</div>\n      </li-->\n    </ul>\n  </div>\n  <div class="bottom clearfix">\n    <ul class="cost-layers">\n      <li class="clearfix">\n        <div class="layer">TOTAL:</div>\n        <div class="range"><%- total_price %></div>\n      </li>\n    </ul>\n    <div class="">\n      <a id="add-to-basket-link" href="add-to-basket"\n          class="btn btn-primary <%= state == \'ready\' ? \' \' : \'disabled\' %>">\n        Add to basket</a>\n    </div>\n    <div class="status-msg">\n      Status:\n      <% if (state == \'ready\') { %>\n        <span class="highlight">\n          ready to order!</span>\n      <% } else if (state == \'select_maker\') { %>\n        select a maker.\n      <% } else { %>\n        select a product.\n      <% } %>\n    </div>\n  </div>\n</div>',h=function(e){function n(){return this.render=t(this.render,this),this.handle_product_selected=t(this.handle_product_selected,this),this.handle_maker_selected=t(this.handle_maker_selected,this),this.handle_change=t(this.handle_change,this),this.handle_add_to_basket=t(this.handle_add_to_basket,this),n.__super__.constructor.apply(this,arguments)}return i(n,e),n.prototype.events={"click #add-to-basket-link":"handle_add_to_basket"},n.prototype.states={select_product:"select_product",select_maker:"select_maker",ready:"ready"},n.prototype.template=_.template(w),n.prototype.handle_add_to_basket=function(t){var e,i,n,s,o,r,a;return this.model.get("state"!==this.states.ready)?!1:(o=this.model.get("quote"),r={name:"quote",value:o.id},i=this.model.get("form_data"),i.push(r),n=this.model.get("default_country_code"),i=f(i,"country_code",n),e=this.$(".add-to-basket-loading-indicator"),e.fadeIn(),a=$(t.target).attr("href"),s={type:"POST",data:$.param(i),dataType:"json",success:function(t){return window.location.href=t.location},complete:function(){return e.fadeOut()}},$.ajax(a,s),!1)},n.prototype.handle_change=function(){var t;return this.model.has("product")||(t={state:this.states.select_product},this.model.set(t,{silent:!0})),this.render()},n.prototype.handle_maker_selected=function(t){var e,i;return e=this.model.get("product"),i=t.get_quote(e),this.model.set({maker:t,quote:i,state:this.states.ready})},n.prototype.handle_product_selected=function(t){return this.model.set({maker:null,product:t,quote:null,state:this.states.select_maker})},n.prototype.render=function(){var t,e,i,n,s,o,r,a,l,h;return e=opendesk.util.currency_convert,r=opendesk.util.display_price,a=null,h=null,t=_.clone(this.model.attributes),l=this.model.get("quantity"),n=t.design_price_currency,s=t.design_price_value*l,o={design_price:r(s,n),mfr_price:"",total_price:""},t.quote!=null&&(i=t.quote.currency,s=e(s,n,i),a=t.quote.value*l,h=s+a,o={design_price:r(s,i),mfr_price:r(a,i),total_price:r(h,i)}),this.$el.html(this.template(_.extend(t,o)))},n.prototype.initialize=function(){return this.model.set({state:this.states.select_product}),this.listenTo(this.model,"change",this.handle_change),this.listenTo(g,"maker:selected",this.handle_maker_selected),this.listenTo(g,"product:selected",this.handle_product_selected)},n}(Backbone.View),p=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.initialize=function(){return this.makers=this.options.makers,this.maker_listing=new a({collection:this.makers,el:this.$("#maker-listing")}),this.products=this.options.products,this.product_listing=new u({collection:this.products,el:this.$("#product-listing")})},e}(Backbone.View),s=function(e){function n(){return this.handle_results=t(this.handle_results,this),this.fetch_results=t(this.fetch_results,this),this.reset_order=t(this.reset_order,this),n.__super__.constructor.apply(this,arguments)}return i(n,e),n.prototype.defaults={query_endpoint:window.location.pathname,form_selector:"#search-form",location_change_selectors:"input[name=location]",filter_change_selectors:"input[name=quantity]",chosen_filter_selectors:"select"},n.prototype.reset_order=function(t){var e,i,n,s,o,r;return i=opendesk.bootstrap.country_code,n=opendesk.bootstrap.design_price_currency,s=opendesk.bootstrap.design_price_value,o=opendesk.bootstrap.form_name_mapping,r=y(t,"form"),e={form_data:t,default_country_code:i,design_price_currency:n,design_price_value:s,form_name:o[r],quantity:y(t,"quantity"),maker:null,product:null,quote:null},this.model.set(e)},n.prototype.fetch_results=function(){var t,e,i=this;return t=this.$form.serializeArray(),this.reset_order(t),this.$loading_indicator.fadeIn(),e={type:"POST",data:$.param(t),dataType:"json",success:this.handle_results,complete:function(){return i.$loading_indicator.fadeOut()}},$.ajax(this.options.query_endpoint,e),!1},n.prototype.handle_results=function(t){return this.products.reset(t.products!=null?t.products:[]),this.makers.reset(t.makers!=null?t.makers:[])},n.prototype.initialize=function(){var t,e,i,n,s;return this.options=_.defaults(this.options,this.defaults),this.makers=new r,this.products=new c,this.selection_view=new p({el:this.el,makers:this.makers,products:this.products}),s=this.$(".action-links .extra-info"),this.summary_view=new h({el:s,model:this.model}),this.$form=this.$(this.options.form_selector),this.location_widget=new fabhub.view.location.LocationSearchWidget({el:this.$form,model:new Backbone.Model}),n=this.$(this.options.location_change_selectors),n.attr({autocomplete:"off"}),n.change(this.fetch_results),i=this.$(this.options.filter_change_selectors),i.change(this.fetch_results),e=this.$(this.options.chosen_filter_selectors),t=e.chosen({allow_single_deselect:!0}),t.change(this.fetch_results),this.$form.submit(this.fetch_results),this.$loading_indicator=$("#map-loading-indicator"),this.fetch_results()},n}(Backbone.View),e.GetItMadePage=s});var t=function(t,e){return function(){return t.apply(e,arguments)}},e={}.hasOwnProperty,i=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t};define("opendesk.view.use",function(e){var n,s;return n=function(e){function n(){return this.handle_delete=t(this.handle_delete,this),n.__super__.constructor.apply(this,arguments)}return i(n,e),n.prototype.events={"click .delete-link":"handle_delete"},n.prototype.handle_delete=function(t){var e,i,n,s,o,r=this;return i=$(t.target),e=i.closest("a"),o=e.attr("href"),n={digest:e.data("digest")},s={type:"POST",dataType:"json",data:n,success:function(){return r.$el.slideUp(400,function(){return r.model.collection.remove(r.model),r.remove()})}},$.ajax(o,s),!1},n}(Backbone.View),s=function(e){function s(){return this.update_video_preview=t(this.update_video_preview,this),this.update_form_input=t(this.update_form_input,this),this.toggle_form=t(this.toggle_form,this),s.__super__.constructor.apply(this,arguments)}return i(s,e),s.prototype.events={"click .js-add-brick-message":"toggle_form","click .js-add-brick-form .form-toggle-btn":"update_form_input","change .js-add-brick-form .video-input input":"update_video_preview"},s.prototype.toggle_form=function(){return this.$add_brick_form.slideToggle(),!1},s.prototype.update_form_input=function(t){var e,i;return i=$(t.target),e=i.closest("button"),this.$form_input.val(e.data("value"))},s.prototype.update_video_preview=function(){var t,e,i,n,s=this;return i=opendesk.util.get_location_path(),i.endsWith("/")||(i+="/"),n=i+"video_preview",t={video:this.$video_input.val()},e={type:"POST",data:t,dataType:"json",success:function(t){return s.$video_preview.html('<img src="'+t.thumbnail_url+'" />')}},$.ajax(n,e)},s.prototype.initialize=function(){var t,e,i,s,o,r,a;return this.$add_brick_form=this.$(".js-add-brick-form"),this.$video_preview=this.$(".js-add-brick-form .video-preview"),this.$video_input=this.$(".js-add-brick-form .video-input input"),this.$form_input=this.$(".js-add-brick-form input[name=form_slug]"),t=this.$(".js-add-brick-form form .alert-error"),t.length&&this.$add_brick_form.slideDown(),s=this.$("input[name=location]"),s.length&&(s.attr({autocomplete:"off"}),s.after('<div id="location-map" class="input-xxlarge clearfix"></div>'),i=s.parents("form"),r=new fabhub.view.location.LocationWidget({el:i,model:new Backbone.Model,map_styles:opendesk.style.map_styles}),s.focus(function(){var t;return t=$("#location-map"),t.slideDown("slow",function(){return r.handle_resize()})})),a=this.collection,e=this.$(".brick"),e.fitVids(),o=this.$(".editable-brick"),o.each(function(){var t;return t=new Backbone.Model,a.add(t),new n({el:this,model:t})})},s}(Backbone.View),e.YourOpenDeskPage=s});var e={}.hasOwnProperty,i=function(t,i){function n(){this.constructor=t}for(var s in i)e.call(i,s)&&(t[s]=i[s]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t};define("opendesk.view.wall",function(t){var e;return e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.initialize=function(){var t,e,i,n=this;return t=$("#brick-container"),t.fitVids(),e={columnWidth:219,gutter:10,itemSelector:".brick"},this.masonry=new Masonry(t.get(0),e),i=function(){return n.masonry.layout()},window.setTimeout(i,1500),window.setTimeout(i,3500),window.setTimeout(i,6e3)},e}(Backbone.View),t.WallPage=e})})()